var kaboom=(()=>{var et=Object.defineProperty;var ys=Object.getOwnPropertyDescriptor;var Us=Object.getOwnPropertyNames;var xs=Object.prototype.hasOwnProperty;var Es=(i,r,a)=>r in i?et(i,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[r]=a;var u=(i,r)=>et(i,"name",{value:r,configurable:!0});var Bn=(i,r)=>{for(var a in r)et(i,a,{get:r[a],enumerable:!0})},Ss=(i,r,a,c)=>{if(r&&typeof r=="object"||typeof r=="function")for(let v of Us(r))!xs.call(i,v)&&v!==a&&et(i,v,{get:()=>r[v],enumerable:!(c=ys(r,v))||c.enumerable});return i};var Cs=i=>Ss(et({},"__esModule",{value:!0}),i);var Z=(i,r,a)=>(Es(i,typeof r!="symbol"?r+"":r,a),a);var Ts=(()=>{for(var i=new Uint8Array(128),r=0;r<64;r++)i[r<26?r+65:r<52?r+71:r<62?r-4:r*4-205]=r;return a=>{for(var c=a.length,v=new Uint8Array((c-(a[c-1]=="=")-(a[c-2]=="="))*3/4|0),g=0,T=0;g<c;){var R=i[a.charCodeAt(g++)],C=i[a.charCodeAt(g++)],O=i[a.charCodeAt(g++)],M=i[a.charCodeAt(g++)];v[T++]=R<<2|C>>4,v[T++]=C<<4|O>>2,v[T++]=O<<6|M}return v}})();var to={};Bn(to,{default:()=>eo});function he(i){return i*Math.PI/180}u(he,"deg2rad");function kt(i){return i*180/Math.PI}u(kt,"rad2deg");function te(i,r,a){return r>a?te(i,a,r):Math.min(Math.max(i,r),a)}u(te,"clamp");function _e(i,r,a){return i+(r-i)*a}u(_e,"lerp");function pt(i,r,a,c,v){return c+(i-r)/(a-r)*(v-c)}u(pt,"map");function kn(i,r,a,c,v){return te(pt(i,r,a,c,v),c,v)}u(kn,"mapc");var H=class{x=0;y=0;constructor(r=0,a=r){this.x=r,this.y=a}static fromAngle(r){let a=he(r);return new H(Math.cos(a),Math.sin(a))}clone(){return new H(this.x,this.y)}add(...r){let a=p(...r);return new H(this.x+a.x,this.y+a.y)}sub(...r){let a=p(...r);return new H(this.x-a.x,this.y-a.y)}scale(...r){let a=p(...r);return new H(this.x*a.x,this.y*a.y)}dist(...r){let a=p(...r);return Math.sqrt((this.x-a.x)*(this.x-a.x)+(this.y-a.y)*(this.y-a.y))}len(){return this.dist(new H(0,0))}unit(){let r=this.len();return r===0?new H(0):this.scale(1/r)}normal(){return new H(this.y,-this.x)}dot(r){return this.x*r.x+this.y*r.y}angle(...r){let a=p(...r);return kt(Math.atan2(this.y-a.y,this.x-a.x))}lerp(r,a){return new H(_e(this.x,r.x,a),_e(this.y,r.y,a))}isZero(){return this.x===0&&this.y===0}toFixed(r){return new H(Number(this.x.toFixed(r)),Number(this.y.toFixed(r)))}eq(r){return this.x===r.x&&this.y===r.y}toString(){return`vec2(${this.x.toFixed(2)}, ${this.y.toFixed(2)})`}},D=H;u(D,"Vec2"),Z(D,"LEFT",new H(-1,0)),Z(D,"RIGHT",new H(1,0)),Z(D,"UP",new H(0,-1)),Z(D,"DOWN",new H(0,1));function p(...i){if(i.length===1){if(i[0]instanceof D)return p(i[0].x,i[0].y);if(Array.isArray(i[0])&&i[0].length===2)return p(...i[0])}return new D(...i)}u(p,"vec2");var ke=class{x=0;y=0;z=0;constructor(r,a,c){this.x=r,this.y=a,this.z=c}xy(){return p(this.x,this.y)}};u(ke,"Vec3");var me=u((i,r,a)=>new ke(i,r,a),"vec3"),ie=class{r=255;g=255;b=255;constructor(r,a,c){this.r=te(r,0,255),this.g=te(a,0,255),this.b=te(c,0,255)}static fromArray(r){return new ie(r[0],r[1],r[2])}static fromHex(r){if(typeof r=="number")return new ie(r>>16&255,r>>8&255,r>>0&255);{let a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return new ie(parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16))}}static fromHSL(r,a,c){if(a==0)return x(255*c,255*c,255*c);let v=u((M,U,f)=>(f<0&&(f+=1),f>1&&(f-=1),f<1/6?M+(U-M)*6*f:f<1/2?U:f<2/3?M+(U-M)*(2/3-f)*6:M),"hue2rgb"),g=c<.5?c*(1+a):c+a-c*a,T=2*c-g,R=v(T,g,r+1/3),C=v(T,g,r),O=v(T,g,r-1/3);return new ie(Math.round(R*255),Math.round(C*255),Math.round(O*255))}clone(){return new ie(this.r,this.g,this.b)}lighten(r){return new ie(this.r+r,this.g+r,this.b+r)}darken(r){return this.lighten(-r)}invert(){return new ie(255-this.r,255-this.g,255-this.b)}mult(r){return new ie(this.r*r.r/255,this.g*r.g/255,this.b*r.b/255)}eq(r){return this.r===r.r&&this.g===r.g&&this.b===r.b}toString(){return`rgb(${this.r}, ${this.g}, ${this.b})`}toHex(){return"#"+((1<<24)+(this.r<<16)+(this.g<<8)+this.b).toString(16).slice(1)}},E=ie;u(E,"Color"),Z(E,"RED",x(255,0,0)),Z(E,"GREEN",x(0,255,0)),Z(E,"BLUE",x(0,0,255)),Z(E,"YELLOW",x(255,255,0)),Z(E,"MAGENTA",x(255,0,255)),Z(E,"CYAN",x(0,255,255)),Z(E,"WHITE",x(255,255,255)),Z(E,"BLACK",x(0,0,0));function x(...i){if(i.length===0)return new E(255,255,255);if(i.length===1){if(i[0]instanceof E)return i[0].clone();if(Array.isArray(i[0])&&i[0].length===3)return E.fromArray(i[0])}return new E(...i)}u(x,"rgb");var Nn=u((i,r,a)=>E.fromHSL(i,r,a),"hsl2rgb"),N=class{x=0;y=0;w=1;h=1;constructor(r,a,c,v){this.x=r,this.y=a,this.w=c,this.h=v}scale(r){return new N(this.x+this.w*r.x,this.y+this.h*r.y,this.w*r.w,this.h*r.h)}clone(){return new N(this.x,this.y,this.w,this.h)}eq(r){return this.x===r.x&&this.y===r.y&&this.w===r.w&&this.h===r.h}toString(){return`quad(${this.x}, ${this.y}, ${this.w}, ${this.h})`}};u(N,"Quad");function jn(i,r,a,c){return new N(i,r,a,c)}u(jn,"quad");var A=class{m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];constructor(r){r&&(this.m=r)}static translate(r){return new A([1,0,0,0,0,1,0,0,0,0,1,0,r.x,r.y,0,1])}static scale(r){return new A([r.x,0,0,0,0,r.y,0,0,0,0,1,0,0,0,0,1])}static rotateX(r){return r=he(-r),new A([1,0,0,0,0,Math.cos(r),-Math.sin(r),0,0,Math.sin(r),Math.cos(r),0,0,0,0,1])}static rotateY(r){return r=he(-r),new A([Math.cos(r),0,Math.sin(r),0,0,1,0,0,-Math.sin(r),0,Math.cos(r),0,0,0,0,1])}static rotateZ(r){return r=he(-r),new A([Math.cos(r),-Math.sin(r),0,0,Math.sin(r),Math.cos(r),0,0,0,0,1,0,0,0,0,1])}translate(r){return this.mult(A.translate(r))}scale(r){return this.mult(A.scale(r))}rotateX(r){return this.mult(A.rotateX(r))}rotateY(r){return this.mult(A.rotateY(r))}rotateZ(r){return this.mult(A.rotateZ(r))}mult(r){let a=[];for(let c=0;c<4;c++)for(let v=0;v<4;v++)a[c*4+v]=this.m[0*4+v]*r.m[c*4+0]+this.m[1*4+v]*r.m[c*4+1]+this.m[2*4+v]*r.m[c*4+2]+this.m[3*4+v]*r.m[c*4+3];return new A(a)}multVec4(r){return{x:r.x*this.m[0]+r.y*this.m[4]+r.z*this.m[8]+r.w*this.m[12],y:r.x*this.m[1]+r.y*this.m[5]+r.z*this.m[9]+r.w*this.m[13],z:r.x*this.m[2]+r.y*this.m[6]+r.z*this.m[10]+r.w*this.m[14],w:r.x*this.m[3]+r.y*this.m[7]+r.z*this.m[11]+r.w*this.m[15]}}multVec3(r){let a=this.multVec4({x:r.x,y:r.y,z:r.z,w:1});return me(a.x,a.y,a.z)}multVec2(r){return p(r.x*this.m[0]+r.y*this.m[4]+0*this.m[8]+1*this.m[12],r.x*this.m[1]+r.y*this.m[5]+0*this.m[9]+1*this.m[13])}invert(){let r=[],a=this.m[10]*this.m[15]-this.m[14]*this.m[11],c=this.m[9]*this.m[15]-this.m[13]*this.m[11],v=this.m[9]*this.m[14]-this.m[13]*this.m[10],g=this.m[8]*this.m[15]-this.m[12]*this.m[11],T=this.m[8]*this.m[14]-this.m[12]*this.m[10],R=this.m[8]*this.m[13]-this.m[12]*this.m[9],C=this.m[6]*this.m[15]-this.m[14]*this.m[7],O=this.m[5]*this.m[15]-this.m[13]*this.m[7],M=this.m[5]*this.m[14]-this.m[13]*this.m[6],U=this.m[4]*this.m[15]-this.m[12]*this.m[7],f=this.m[4]*this.m[14]-this.m[12]*this.m[6],ue=this.m[5]*this.m[15]-this.m[13]*this.m[7],I=this.m[4]*this.m[13]-this.m[12]*this.m[5],Y=this.m[6]*this.m[11]-this.m[10]*this.m[7],Ee=this.m[5]*this.m[11]-this.m[9]*this.m[7],Se=this.m[5]*this.m[10]-this.m[9]*this.m[6],rt=this.m[4]*this.m[11]-this.m[8]*this.m[7],it=this.m[4]*this.m[10]-this.m[8]*this.m[6],Ce=this.m[4]*this.m[9]-this.m[8]*this.m[5];r[0]=this.m[5]*a-this.m[6]*c+this.m[7]*v,r[4]=-(this.m[4]*a-this.m[6]*g+this.m[7]*T),r[8]=this.m[4]*c-this.m[5]*g+this.m[7]*R,r[12]=-(this.m[4]*v-this.m[5]*T+this.m[6]*R),r[1]=-(this.m[1]*a-this.m[2]*c+this.m[3]*v),r[5]=this.m[0]*a-this.m[2]*g+this.m[3]*T,r[9]=-(this.m[0]*c-this.m[1]*g+this.m[3]*R),r[13]=this.m[0]*v-this.m[1]*T+this.m[2]*R,r[2]=this.m[1]*C-this.m[2]*O+this.m[3]*M,r[6]=-(this.m[0]*C-this.m[2]*U+this.m[3]*f),r[10]=this.m[0]*ue-this.m[1]*U+this.m[3]*I,r[14]=-(this.m[0]*M-this.m[1]*f+this.m[2]*I),r[3]=-(this.m[1]*Y-this.m[2]*Ee+this.m[3]*Se),r[7]=this.m[0]*Y-this.m[2]*rt+this.m[3]*it,r[11]=-(this.m[0]*Ee-this.m[1]*rt+this.m[3]*Ce),r[15]=this.m[0]*Se-this.m[1]*it+this.m[2]*Ce;let Ut=this.m[0]*r[0]+this.m[1]*r[4]+this.m[2]*r[8]+this.m[3]*r[12];for(let Te=0;Te<4;Te++)for(let Ae=0;Ae<4;Ae++)r[Te*4+Ae]*=1/Ut;return new A(r)}clone(){return new A(this.m)}toString(){return this.m.toString()}};u(A,"Mat4");function Nt(i,r,a,c=Math.sin){return i+(c(a)+1)/2*(r-i)}u(Nt,"wave");var As=1103515245,Os=12345,Ln=2147483648,Ne=class{seed;constructor(r){this.seed=r}gen(){return this.seed=(As*this.seed+Os)%Ln,this.seed/Ln}genNumber(r,a){return r+this.gen()*(a-r)}genVec2(r,a){return new D(this.genNumber(r.x,a.x),this.genNumber(r.y,a.y))}genColor(r,a){return new E(this.genNumber(r.r,a.r),this.genNumber(r.g,a.g),this.genNumber(r.b,a.b))}genAny(...r){if(r.length===0)return this.gen();if(r.length===1){if(typeof r[0]=="number")return this.genNumber(0,r[0]);if(r[0]instanceof D)return this.genVec2(p(0,0),r[0]);if(r[0]instanceof E)return this.genColor(x(0,0,0),r[0])}else if(r.length===2){if(typeof r[0]=="number"&&typeof r[1]=="number")return this.genNumber(r[0],r[1]);if(r[0]instanceof D&&r[1]instanceof D)return this.genVec2(r[0],r[1]);if(r[0]instanceof E&&r[1]instanceof E)return this.genColor(r[0],r[1])}}};u(Ne,"RNG");var Vt=new Ne(Date.now());function _n(i){return i!=null&&(Vt.seed=i),Vt.seed}u(_n,"randSeed");function tt(...i){return Vt.genAny(...i)}u(tt,"rand");function jt(...i){return Math.floor(tt(...i))}u(jt,"randi");function qn(i){return tt()<=i}u(qn,"chance");function zn(i){return i[jt(i.length)]}u(zn,"choose");function Hn(i,r){return i.pos.x+i.width>r.pos.x&&i.pos.x<r.pos.x+r.width&&i.pos.y+i.height>r.pos.y&&i.pos.y<r.pos.y+r.height}u(Hn,"testRectRect");function Ps(i,r){if(i.p1.x===i.p2.x&&i.p1.y===i.p2.y||r.p1.x===r.p2.x&&r.p1.y===r.p2.y)return null;let a=(r.p2.y-r.p1.y)*(i.p2.x-i.p1.x)-(r.p2.x-r.p1.x)*(i.p2.y-i.p1.y);if(a===0)return null;let c=((r.p2.x-r.p1.x)*(i.p1.y-r.p1.y)-(r.p2.y-r.p1.y)*(i.p1.x-r.p1.x))/a,v=((i.p2.x-i.p1.x)*(i.p1.y-r.p1.y)-(i.p2.y-i.p1.y)*(i.p1.x-r.p1.x))/a;return c<0||c>1||v<0||v>1?null:c}u(Ps,"testLineLineT");function Ve(i,r){let a=Ps(i,r);return a?p(i.p1.x+a*(i.p2.x-i.p1.x),i.p1.y+a*(i.p2.y-i.p1.y)):null}u(Ve,"testLineLine");function $n(i,r){if(qe(i,r.p1)||qe(i,r.p2))return!0;let a=i.points();return!!Ve(r,new re(a[0],a[1]))||!!Ve(r,new re(a[1],a[2]))||!!Ve(r,new re(a[2],a[3]))||!!Ve(r,new re(a[3],a[0]))}u($n,"testRectLine");function qe(i,r){return r.x>i.pos.x&&r.x<i.pos.x+i.width&&r.y>i.pos.y&&r.y<i.pos.y+i.height}u(qe,"testRectPoint");function Yn(i,r){return i.center.dist(r)<i.radius}u(Yn,"testCirclePoint");function Xn(i,r){let a=!1,c=i.pts;for(let v=0,g=c.length-1;v<c.length;g=v++)c[v].y>r.y!=c[g].y>r.y&&r.x<(c[g].x-c[v].x)*(r.y-c[v].y)/(c[g].y-c[v].y)+c[v].x&&(a=!a);return a}u(Xn,"testPolygonPoint");var re=class{p1;p2;constructor(r,a){this.p1=r,this.p2=a}transform(r){return new re(r.multVec2(this.p1),r.multVec2(this.p2))}bbox(){return V.fromPoints(this.p1,this.p2)}};u(re,"Line");var V=class{pos;width;height;constructor(r,a,c){this.pos=r,this.width=a,this.height=c}static fromPoints(r,a){return new V(r.clone(),a.x-r.x,a.y-r.y)}center(){return new D(this.pos.x+this.width/2,this.pos.y+this.height/2)}points(){return[this.pos,this.pos.add(this.width,0),this.pos.add(this.width,this.height),this.pos.add(0,this.height)]}transform(r){return new se(this.points().map(a=>r.multVec2(a)))}bbox(){return new V(this.pos.clone(),this.width,this.height)}distToPoint(r){let a=this.pos,c=this.pos.add(this.width,this.height),v=Math.max(a.x-r.x,0,r.x-c.x),g=Math.max(a.y-r.y,0,r.y-c.y);return Math.sqrt(v*v+g*g)}};u(V,"Rect");var de=class{center;radius;constructor(r,a){this.center=r,this.radius=a}transform(r){return new je(this.center,this.radius,this.radius).transform(r)}bbox(){return V.fromPoints(this.center.sub(p(this.radius)),this.center.add(p(this.radius)))}};u(de,"Circle");var je=class{center;radiusX;radiusY;constructor(r,a,c){this.center=r,this.radiusX=a,this.radiusY=c}transform(r){return new je(r.multVec2(this.center),r.m[0]*this.radiusX,r.m[5]*this.radiusY)}bbox(){return V.fromPoints(this.center.sub(p(this.radiusX,this.radiusY)),this.center.add(p(this.radiusX,this.radiusY)))}};u(je,"Ellipse");var se=class{pts;constructor(r){if(r.length<3)throw new Error("Polygons should have at least 3 vertices");this.pts=r}transform(r){return new se(this.pts.map(a=>r.multVec2(a)))}bbox(){let r=p(Number.MAX_VALUE),a=p(-Number.MAX_VALUE);for(let c of this.pts)r.x=Math.min(r.x,c.x),a.x=Math.max(a.x,c.x),r.y=Math.min(r.y,c.y),a.y=Math.max(a.y,c.y);return V.fromPoints(r,a)}};u(se,"Polygon");function Kn(i,r){let a=Number.MAX_VALUE,c=p(0);for(let v of[i,r])for(let g=0;g<v.pts.length;g++){let T=v.pts[g],C=v.pts[(g+1)%v.pts.length].sub(T).normal().unit(),O=Number.MAX_VALUE,M=-Number.MAX_VALUE;for(let I=0;I<i.pts.length;I++){let Y=i.pts[I].dot(C);O=Math.min(O,Y),M=Math.max(M,Y)}let U=Number.MAX_VALUE,f=-Number.MAX_VALUE;for(let I=0;I<r.pts.length;I++){let Y=r.pts[I].dot(C);U=Math.min(U,Y),f=Math.max(f,Y)}let ue=Math.min(M,f)-Math.max(O,U);if(ue<0)return null;if(ue<Math.abs(a)){let I=f-O,Y=U-M;a=Math.abs(I)<Math.abs(Y)?I:Y,c=C.scale(a)}}return c}u(Kn,"sat");var mt=1.70158,ft=mt*1.525,In=mt+1,Gn=2*Math.PI/3,Vn=2*Math.PI/4.5,fe={linear:i=>i,easeInSine:i=>1-Math.cos(i*Math.PI/2),easeOutSine:i=>Math.sin(i*Math.PI/2),easeInOutSine:i=>-(Math.cos(Math.PI*i)-1)/2,easeInQuad:i=>i*i,easeOutQuad:i=>1-(1-i)*(1-i),easeInOutQuad:i=>i<.5?2*i*i:1-Math.pow(-2*i+2,2)/2,easeInCubic:i=>i*i*i,easeOutCubic:i=>1-Math.pow(1-i,3),easeInOutCubic:i=>i<.5?4*i*i*i:1-Math.pow(-2*i+2,3)/2,easeInQuart:i=>i*i*i*i,easeOutQuart:i=>1-Math.pow(1-i,4),easeInOutQuart:i=>i<.5?8*i*i*i*i:1-Math.pow(-2*i+2,4)/2,easeInQuint:i=>i*i*i*i*i,easeOutQuint:i=>1-Math.pow(1-i,5),easeInOutQuint:i=>i<.5?16*i*i*i*i*i:1-Math.pow(-2*i+2,5)/2,easeInExpo:i=>i===0?0:Math.pow(2,10*i-10),easeOutExpo:i=>i===1?1:1-Math.pow(2,-10*i),easeInOutExpo:i=>i===0?0:i===1?1:i<.5?Math.pow(2,20*i-10)/2:(2-Math.pow(2,-20*i+10))/2,easeInCirc:i=>1-Math.sqrt(1-Math.pow(i,2)),easeOutCirc:i=>Math.sqrt(1-Math.pow(i-1,2)),easeInOutCirc:i=>i<.5?(1-Math.sqrt(1-Math.pow(2*i,2)))/2:(Math.sqrt(1-Math.pow(-2*i+2,2))+1)/2,easeInBack:i=>In*i*i*i-mt*i*i,easeOutBack:i=>1+In*Math.pow(i-1,3)+mt*Math.pow(i-1,2),easeInOutBack:i=>i<.5?Math.pow(2*i,2)*((ft+1)*2*i-ft)/2:(Math.pow(2*i-2,2)*((ft+1)*(i*2-2)+ft)+2)/2,easeInElastic:i=>i===0?0:i===1?1:-Math.pow(2,10*i-10)*Math.sin((i*10-10.75)*Gn),easeOutElastic:i=>i===0?0:i===1?1:Math.pow(2,-10*i)*Math.sin((i*10-.75)*Gn)+1,easeInOutElastic:i=>i===0?0:i===1?1:i<.5?-(Math.pow(2,20*i-10)*Math.sin((20*i-11.125)*Vn))/2:Math.pow(2,-20*i+10)*Math.sin((20*i-11.125)*Vn)/2+1,easeInBounce:i=>1-fe.easeOutBounce(1-i),easeOutBounce:i=>i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375,easeInOutBounce:i=>i<.5?(1-fe.easeOutBounce(1-2*i))/2:(1+fe.easeOutBounce(2*i-1))/2};var xe=class extends Map{lastID;constructor(...r){super(...r),this.lastID=0}push(r){let a=this.lastID;return this.set(a,r),this.lastID++,a}pushd(r){let a=this.push(r);return()=>this.delete(a)}};u(xe,"IDList");var W=class{handlers=new xe;add(r){let a=this.handlers.pushd((...v)=>{c.paused||r(...v)}),c={paused:!1,cancel:a};return c}addOnce(r){let a=this.add((...c)=>{a.cancel(),r(...c)});return a}next(){return new Promise(r=>this.addOnce(r))}trigger(...r){this.handlers.forEach(a=>a(...r))}numListeners(){return this.handlers.size}};u(W,"Event");var oe=class{handlers=new Map;on(r,a){return this.handlers.get(r)||this.handlers.set(r,new W),this.handlers.get(r).add(a)}onOnce(r,a){let c=this.on(r,(...v)=>{c.cancel(),a(...v)});return c}next(r){return new Promise(a=>{this.onOnce(r,a)})}trigger(r,...a){this.handlers.get(r)&&this.handlers.get(r).trigger(...a)}remove(r){this.handlers.delete(r)}clear(){this.handlers=new Map}numListeners(r){return this.handlers.get(r)?.numListeners()??0}};u(oe,"EventHandler");function _t(i,r){let a=typeof i,c=typeof r;if(a!==c)return!1;if(a==="object"&&c==="object"){let v=Object.keys(i),g=Object.keys(r);if(v.length!==g.length)return!1;for(let T of v){let R=i[T],C=r[T];if(!(typeof R=="function"&&typeof C=="function")&&!_t(R,C))return!1}return!0}return i===r}u(_t,"deepEq");function Rs(i){let r=window.atob(i),a=r.length,c=new Uint8Array(a);for(let v=0;v<a;v++)c[v]=r.charCodeAt(v);return c.buffer}u(Rs,"base64ToArrayBuffer");function Qn(i){return Rs(i.split(",")[1])}u(Qn,"dataURLToArrayBuffer");function gt(i,r){let a=document.createElement("a");a.href=r,a.download=i,a.click()}u(gt,"download");function qt(i,r){gt(i,"data:text/plain;charset=utf-8,"+r)}u(qt,"downloadText");function Jn(i,r){qt(i,JSON.stringify(r))}u(Jn,"downloadJSON");function zt(i,r){let a=URL.createObjectURL(r);gt(i,a),URL.revokeObjectURL(a)}u(zt,"downloadBlob");function Ht(i){return i.match(/^data:\w+\/\w+;base64,.+/)}u(Ht,"isDataURL");var Zn=(()=>{let i=0;return()=>i++})();var ze=class{dts=[];timer=0;fps=0;tick(r){this.dts.push(r),this.timer+=r,this.timer>=1&&(this.timer=0,this.fps=Math.round(1/(this.dts.reduce((a,c)=>a+c)/this.dts.length)),this.dts=[])}};u(ze,"FPSCounter");var pe=class{time;action;finished=!1;paused=!1;constructor(r,a){this.time=r,this.action=a}tick(r){return this.finished||this.paused?!1:(this.time-=r,this.time<=0?(this.action(),this.finished=!0,this.time=0,!0):!1)}reset(r){this.time=r,this.finished=!1}};u(pe,"Timer");var Wn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhQAAAC0CAYAAADM+bUiAAAAAXNSR0IArs4c6QAAHTdJREFUeJztndnW5CiuhSN6nfd/5TgXne5yuhg0D3h/V92VNpJAgJAI/58PeB2/P2TrAQAA4By+2QqAWJ6BxPf7hQ8AAABQ859sBQD4fJA1AQCA7vxftgIUro0m+jSdJbcjo2CA2m/3d3+/30/S35RgBOMIAOhGp6xyWcUuvDtzFjREDeIuaNEGNbuN1sIujQxNIEKRrWmbI7/yJAcA6FitM957Q7ZMjqzyi6DWQE7b93YjAoqdDK0OUZutJjugsVFSIrEcx8yTQ1Sg7dU+AB3grDFe+1K2LI483KE4FMlmG/VO9rvdGdlu2R/e7QMQheZuFvc9izkSNc+4/UJ9FgFFEp6OE7VRj06xFxLZ2qj7O0DTXkUyN/ZTgwpcCD6T592sKJlRAYwUT/0QUBRhV+6waF9ySdILD/ss26tIVE2Ve+elMxmbDvDHayyphxVL+Z5l2pk8aon6CQKKJmicavWu1HGseUNAoGE2Hl6ZGM2iAkA1LO6fPduwnnve7e8OJE95kvmPgAKYOe7laLsNBxuSDRFBWHSgh/ID0OLhP7tD2ejfJXpEl2t3srh6vDqgWEVjlEiNym/A7pnZv2v02GFhs3QSSWRlY+kjKyinJU+sFssdKD8ADyyyEyew2uM4761o8WErTyyjsxHWzvn7yT78RIXT9vf7/VJrctf/jpysEbK6BkMAnEhmMEBdDzPxXq9enaEAsUSetLNP9VZUsSMqS7EDJRHAwWKudFw3skBA4Yy1M1Zz7p0+3hmgC6TLzwdjDFZU9ImKOnny+pJHBKuUP+XkZ3GHI6JMstLbemKN0ou7W8yW8rPItMMypXu1Q7XnbQsz0HPKnO8EAopieC2c1e4TWKUiuXc4QD6jTMNsjGbjyxlTju9byAPxWAe6Ujrco/AEAUVxJAtZNafOviiVJRvQmf2yafSsVzCxa6eDL3Ht7WCTBCu7Tu0fDhyfwh2KQCI31u8fds+tfqrqhdUk3ZU4nnJwoa8GmvHHAj9H4tsnzIcTbDgFBBSJRCyO3NOcx89cLdu72ty1u7pfgQUoH2nmLeIdz3aAPxgrO7i/MkPJ4wVwL0d6pnctLphynsXiUpfZZd7Zc1o5I6wvQGciKXV2tvfzweHAE0nfIqBwgrpxU5+JnvgWm3FUtmMVMGHBqc9uI0RgSOft/fR2+62Q3l9CycMBrzS/dZufT+xfltRMdqqDY0Hph1XwDd5FhE+80e80l6ERUACXv1gZMRFnOu9sQdBRB24J640LPKBRYV539s/V/KL2bbuAooLT7PDQUXK5MqueurvI85tgqWsHP5GQuWBFlbCi9YhG6vPgHyIzthpZXdahlY0cG8rfobjXV7sMzuezvwg5+knj7hkKszsEmX1HvRQaoWsnHzoZyiK9urTZ9V7FaH52tKMa6EMZu3nI7dcWGQqPlHwmFFs8ShAz57E8MVECBk0bWj26nQqtT0xSrAJeSVunzP1TfHKHdwbGu7+kc67bOO6yEpJ51yKgAHS4TmCV6vJsg8tuYneb+CMibchYwEfP3J87Jcg4jVmG1JMoX+Aelir7qNe6X77k8fmc9VvxCO5lIk0b3He4MqmlEA/ZnVLNs/GMsGHWrxq5mjJmlzF7I6sMjOf9LA9Wc+7+TIQu1njM6YvyAUX3+mlWqmxVf6a+a6WDBxy7MjdkK3YLnEeJbKWLtv0q/R55R8si0Ad/433fSlrCtSwHUp+jyLQoSa9kouQRTPT9ie8N6rMSORJnvN7xXGQve2Z2dVrgV2NjaYd3MFENjd9LZEXIOZGMuRo5XtFZWgueMhFQvIjR5OAEHFpZI6iTQJIaf75zwmKeaUPECT5KVhadAtjqVA0CT/VdCggonMEiyWfWTxZZlhOCjAydIxfvjmNCwbN2XQHNvOW2H91n1IOXRi+tTdHZ71F7LRz5DZcyo+q4Hn3JaXMXfJw4tp5436HAeNjR7ZcAAHCBM78Mr+CMuwFhcQVv5IRfCQAAwP/4/SFbDwAAAAAAAAAAAAAAAAAAAAAAKAbKqe8Gl4IKgItaALyDkz8a9oZf44E1Zl8P7Oo82mhaa7fnrx0sTgoaXSJ/IkqxtauPgt5wPxPvqYsn3r8g49C5Hztj/qeRLb9rMGvL6jfyVqk5603X49sQGrj6SGVL7MZiAyrzJv/0WMsq7Ec7PaLWa69vzXBZfjjQSghV4I5dlGsZBWcHFNWzExccnSIXAI2sros26EOmf0ZvUF5fAc3ej7g6RByKKhw4Zzr869PbFZTthOWkrNoWFYtxp7ahlfUmHwXx7E60d7jva2Q/n7sjlWehiycRfXl/3tvmCn06Y/jnyy1Oib9fnz8NfRGpb4RTWETLFn3CXTR3viM5DY3e6eijQIdVuVTCTOb3O//T9FQ9rYL56vNhp5/lfqQNRDz7MnOsVnKHAYWk8cpR04hMfT1LHRqsI/mdTZa+Q5FlPeYewVdluSs9Kvjvjru+0QuydC5Q9LT0a4+NN7KvrdYUyqHFaw8Z9ZX3gciqHbO/NopSCY1ONmrGlPOu1neo73vXjCPGNkvuU95o44vUwQJPne++5n1S3elBKbFw2uyAR58/21z1qbV8bpY3C3WGwpNKJ4hTZVeg2qTQ4Hkaq9BPFXSwxLMEImnTKpO2kv38N+sxHdnQoZyygpph8taheunWLKA4baGJooojWJc7It4FcVBOwlG6SFlt1pUWZQ2clPz1rCYAWJUGus7tynprSmMRmJQ8LAag8iBa0clGz3LH74a1bGDPym+pafQqrHTtND8/n7W+FFvuz1SrxWuxHMsqNt0Z6VTBf1UZit1Co2k7ehAzNrcqjppV+x9RpU/Af/Ga41qfswh4q6ePuazsmrGyd9cX3DGM6ltkTPMQBRQnpD+pPG2V2jZbvCjvRvenVt594eBM0E5+M0vpegegkTK9gmyrjKbFoaVaUEHtm1XpxlYjOZFljzftSRcV76psAwquQ0iMqTQJdly6Rg5atpPsmDk25317rf7Gw8cyxuTZ192CiWpUCio0PrrS9flvq7H10uEuOzqz5Vm+BX+zDCg6bfRctJOHMzGqnMhm7Vq3ScXKnl3a1kJGJbwXOe9gwuLkatkHq6DCWtYMrz6PDDgrzrXTAwKrLBClDUpfmv9s1GISRjmBZX0wgohTk7T9yPTmiIrj1ZGozES1hX7lv97zjtvn2nLH3da7jMjyRNT4V8/udoLSl8tfeUSnpirxfTB6xsrGp6yVTEssx0jS1u8P3PewQPjwljLHjIi5Tm3Xos93trxlXLvvRVwy7d1mKKh1MakCXQb76gdLfXd9G33qly4wWh0lp4hqafNTeWMfrUoglv1hFUxwnr/L3NnjGVxJ+1KaVUamQk9YySNqAp7CG/qEm0rNCirAfxn14xv8NIuMbNBuw9W07X3w5Orwpv2o0uHK7A6F1eJ+4oBXxGpyUzai5/+3rFVTn3/KhJ/tOXUB3uG98WUEb542VfQRHHJzML2UaRFUcN/HRmGDpN+kC6NH+WjFiVkMa79fLcAW7Xdh5SsWfRDpixpZUXe4POUggxmP2V8brQIcaE+VPsrapKzr4E+s2l7JpPw3LtL69CmsyhDeG59X2zu4Pls9SKkg880cF1B4cuqiajXpKk5ezzFblW6iZVrx1qAi406DdfsZ81grs7pPVdfv86mlo2lAITHMesJSLwdFnSZBHhhfGbug4rR+jQwm7m1atX/Xf9em5t+9s2AVGOl3mr97YnKHQtvhHCfT1o6f71PreNL7ArO2sm5FV5ocGbpUX9CqsLvnor1bEblmSPToVuK4rymUoMFyPdPifZfCAq2/e5CVVVshDigoC0Klzl+xcmivTW83iaI2W+v7BLv2ouzKXDBPumjmEVhY6K/dhCouxlRWF2ip+lvYKW0jyoelMlb6UfzdO/iodCh84raJRnWmRE6GfRX61GOTtXRu6+DGq+0MOTN5UXJXsrl6WPmMdXakQzBxh9qPFnZZrx3U9iTza9cvVL2j1uydjRw9Im0byTOvF0UvqBkp104yV/K9FhoJnsGEdfszeScHEzsd7kQEFZ2DibsO0QG9Zb9Z604JKLREHwSrBtheB0Hz71BYtueJJO2mtU+a6qvcr9r0pbVtGaWOzPGJlr0rgXDbqUBmQKYt3XDnn1TeU06l8aMitfvzKV5mKDQWqpJHliGWJ8IsW61OelK5GfbciSpBeMrKoNqiHl3y0ZKtr5d/eqTFI9itRxVKxXe8+jlj/fTo2zKOBYAV1TZdUIuoEtVK9h0E12tOy+quWNnawabyCgIAwEkg4AUAAAAAAAAAAAAAAAAAAAAAAAAAAOBcSl4IyvpJJZATfXM+86Y+AACAf1Pui3ZVvmfggbQvJTZ6fQmNIst7TLK/JQD0VPoYmieZh6Od7E79CHoQ8oecvD8/KvmAiGYySdqIDMw8vuq2kv+WgII77lJf0/po9exNxqeGJbK1/S8h44NFVf2kM9XnoBfkTUIlhHnCjZJjsSBxNxcppwUUmgmXEVBwZVr5iTbDV3FBi1xbLORGz73qgUz0+HUrp3aag9aHlv/oVVuj6czvgNXzHhupFdp+iJIV0d59nCqPWQWy+udHJEO3p56Wz1m/GyVPq2NEP0ra064VXD+NXJs85hClTYs+nb1P/uNgkXW+lazr3yosZlxGdnlFs5oTh2dE3XHcRvx+8z+y1N1G6QIs9RvvLJ/FeKzGm0KWr3Dkam2sxnPjy8hkUp6z0k3aJvfZ1b+7Zyi4UA0bPXfSZDgRbvB4El1OyJX1nGUpV3Jn/zbKfu6yoBL7dm1KbKI8S5FLbd/ivaj2rNH6dEX7LHV6tmX658ujqThYYEznYKJCxiHihFXhJG/JKphYvbfKglaybwb3UHbZqTnM3YnMeFrz/fL+HPwpUPya0i+pGYo3Dtwb6RxMrJhtOBm6aMk+yXPQ+A7n3UgfzZwPu/EENDKze9z3LTJ9ozbKlTzAWZwaTGTgtVFrTvJVx9LK77TlCNAf6Xh7lJwsZHN14MylUgFF1cUJyEAwYY/1ZiYNJnbPVtt03+R31fq+GxJf8ezz3x+82n/K2j2z6p9SAQU4h7cEE8+b1dRnqWT0WfVxit4wI/rDI1BEYJGHlc9w1hcJFvcm7iCgAOa8JZjY4WWz50Yh1bnS+HbbSLXzZXef5Y5Ux7fzpr67bJX4JflXHpwOrbS4gHw6+0OFhWR087zDrw08OClYtfStqw84WbKu/RYB59ceVuP4nNOzS9/W4zZbX0bP7dpy+dlol8WuwmZxOh38gAN18kXIBTQq+aC2Rk15l7sRVuqfE6D2p9WctmjDSheUPIAbpy5UljeoNbwtwOiYneCWHCzs4f765m1+JCWyn1aydnp4zAlqmy4ZCmuDulxmA3/TJVMViaZP3lb6eNtG55HKvv43pRRyqh9JoZzaT/LRmb0cv0j/Wx47pAOGCVKDt4+DdanixNKH1J4T/CrKhqec03woit16doJPamj96W0tksHHRORzYlCx2tijbT2xf3dE2ms95yuM1duyXVJW89xrL6C06zFWKzupssrfodCkh611ATRGfd8xEKuq8yn9K4F7P4AK9Y7DpYNWluZ9K7BG2mLRn7OSg/dYWZV2ygcUn8/87wmsnsvQswKchdGTEze9Sn7lpUvFMdLOa85iGWV/xX4GNKxLmBo9vPxIqleLgALQyFgYV5wYVNyZBbW79zJTpV5oZM8ODFmHA8t5tLKhSvAP1mSuY3fZlLkgmS9UWyjPlQooOIOEibinQh+dHlRQ8NoULdq1GJ9q42ll0yz9bKWTVDdQj0rZSw4rH5fMo9SAousgnETEYnZyUME9QXjKz6DKxVQNUbrushXSdn83uO9JZWbRUWdLvH312T5XXqkMxedDv+EaoUs3uBt3ZD+eHlR02kCfzMZmtkntNrAKfbGyifq85Bmpbp+PbD4836Gun13mnnTdsLbvxMOCtI9W75ULKHZ0mQiV+E0YPevpxJ2Ciqp6jYhYeKin4ArBxAX37kKk7p73Kmbv79quNHY7qhyUPh99v2XfE9rpwdEv/TsU32/O30Y4lVF/ct611mckYzTeGtkR9lr3jdbmJ5pxt3j/akPzvgcru7j2Xs9bZipWulGzJqM2uLZVHLsLCxsr2zdipa92rloE0zP/bJeh6Ao1S0B9boVk8mSfzjKCyEiZHRY0aemmesnHIxi0amulG1VOxxMyF42OnqWqSn0n1UVa7hv5Z4mAotKgeGCxAHkGFVXqg8hM6S55Wi6clCCheiBxp7KeFrqdGAg+qX5Q0sCd91K7tFnM3TPTksc9rRIxKJcMisGcZ9/Mqp8qTDRp6k6b8ru3Q5ER3Vfa05il3hX8xArJGkN9/v6epP8t1jTqvOg8ptIxtJTvtS5UOdhxeJY+yjoWZRN8PkPpHAtnkLRxYn36jqZfszbuDN5k64qO/RClc8e+eXKCDR3Q7EVWWY6jxlhyxwAAAAAAMrDvAgAAAAAAAAAAAAAAAAAAAADAe0CNGAA+59zOBAAAA46+xQ6AI399h8Lypz73SYkJCUBt8DM/UB34aH2mH2+x+E4Dtb2oT9lq5Xd15NPtAzpwIv8b9Ec9MCY9mH56W7rJc9+zrlN6ytfomlWTjbJv1y7q0QAAoOd3I1uXJ8u/Nvr8rOaOmYFvjybv/cLt0848/eFNtgNQDazPNmSW86uvqf/LUFh803v033ftdvoeulXbkZFllrPNbKwYVUuoekIA4MnOV+HHdEYbepYuVliuZX9lKEZ/XIYSAWkjX6t7D1X/GBL1j/Z4EXV/hdpm98tVz4zT59PXFnA2J2x4wA/r7Pm/7lCMGpQ4pecC6xVMRHLiROdGuif1wUm2gDOg+mS3tfPNPMeq2tgN71BwMhXRm3vXYCI7S+ENJUs1eqZaDVDDSbaA3qzWGi8f3a1vJ8yN5zqeYVPlfpxeyqQEFV039yqcsgFRS16zoKpbP5weHAIfsjfc6IPe6plO8/1JZ901UMq7y195zBrNWlC7BzBv2ohm43L9d8ldnUrM7PAg47QJbOCWAL3GMzuYGL0D3+0D9a7FMqBYnShnz3MVpdI9mJhxwsS6+wnnIu4JwZXEdg6nX3C9yD69e/CGjfaEOdyRyHnPGeNthoK68FeLgKtyykb6RDL+3ptxFFk16eezUQGNpRyqjd3S5Zo53iWooB4svda77H0pC2q2wFoWBVLJY7cJ4mKKji4LiAdvtXtH5uk2Kisi3Wgs7MwK6kd6n3Cv6GKks0d5kBOIWvdjt+BWiqQSMf30NqcRT04sdXTXH/iymsgX0TqN+P1B+q61PlS53rJna9buXlF3dnZEZS48eerc0QYK0msNrEuZo0xFpXRLZ7qeSEAMT9+Ynfoy/MhSJmXTkcqqlJUYPeMZnEk3iBPA2spD4yvsX3lkc4pjnHqXAuiompGzTFtzbLSyPepOQ/Sc1srrvtnOdK8QaJ8Ete/IJY9oqi6sniDAAE+4aWRr2c9UPXUBr8Tu/leFMlLl/gPvQbvvtslQZE94D5ClAFVZzTfr9HzG3B7JtMzC3PGc49o1pPO66uWjQE7JgOLNjoDUHMjGu+afDSXrk20bZw0YPRt51+0ucyUnu08BH67flC153Dl5gz3ZNgB2wP//Tec+Gf2KxuOXNZ37qBPccSsXUCCKRR8A8FY6bZS7bETET3SBP5wxLFXyqFJfjaZCihUAYM/p65dm7Tq9bzoyG09qKb5chgL8FwQYoDJW/gk/7w8Cg7PQ/JKrTEDx1uzExZtsBeAONahAGr0uFX56+waifF8aVJQoecyUfHsqDb/4AJKb895+own+pSny7A8VSeVx3rvb2HXed/xOSSW4PuDpJ5LyR4mAwhrNYjNz/IgJ7nmXAhO6LzN/jvCVu1yruTHy8+v/P9vysHG1PnjJ+3x4my0OE+8jO2gewQ0qjgwoPMgaXAu5pwYTJ2awVhOY085uE+O2EwVVXlW7VoeC0+ahJqNSeQ5WooLPcIKKEncorJ2rs7N21j0SzUSrMElXWPqAt61SXTU2Vt+8LORVXwdGp+m3BFJeVB5zanZNVBOkCOoExeGj7bQ6YT7bW9FpLLWLVAdbOTauTsYUWyX9GembFjKjfSYzg+a9TmfMP8maGLGOZvWttU2Suz7P91T3DDosyuBcTix5POEGglYbidV9Ca08a7ncxTqydOS1MWWN2YpOc/CJptQjkTEiu/9mvtV2UAEAAOSSmdkC9cDAAgAAUHFaSRUAAAAAAAAAAAAAdAUpKAAAAG2J+OVFJJ3taaEkAAAA8GR1d6PLJnynuz0lPmwFAAAAcMj6YNbqI17ecqNlcikf8QAAAAB3sr7TEPFhx+rfoFjB/lse+KgVAACAapyyJ60+VFcdVsnjblw3QwEAAJzJKcHEk2524Q4FAE3Iqt0CAAAF/PnyFxD9x2Y4crtF4Fk8s4PoNwBANZChOBzOidbqBMxpByduAAA4A2QoDka6WWtOwG8JEKL+5DYAAHQBAQUYIgkq3hBMSGzsUqKQ/IKL+w5+JWaPpk81Yy4FY38uCChexGwizxYIq43w2YZVWWUlw4OTAybJHQ3uO9H3QCib5V0njs1VNkVNn2rHXEqXABvwKRVQZH52NPpjIpU+XnLJ0iwWo3ejPi5z/TeOHZHZFyyedlA3dMpm+RzT3UYnDaA8Mz6j96MCgyw6626BdUBmuXanBxScy3sWnTiasBQdrOVTn4sOLKwma8YmytHdK/sC/IjOcMxkc5/3yvhI0QbHb9/QT2E1jlL/Sw0oJI6pOdmPJix3E9rJoLzPfQeb1t9UWNSyF/vZc6f6ivV4R/sPJ/vBYTQXJGsG53ltBsR6/TzV5y9mY3z9m6RN7SH6/v79mVY/G6V2gmV7Vu9pFrDszbMi3z9o3rfUxwKLce7kKxV1HekkSQlTSiya9rNkUVht/JGHsTfgvRf9/rB6//7/0zIUlAg2w4meDu+5yFOiv/t/q7gJVsW7xgjisN4Eo8aTkj3w3OAjZa1keMjxbrcaVllZ6b5LlV0uQ3F3kOjU2OjftSdhjizKv3lyysbZdZHpqjcVK/uy+8kqe2C5we/ey5zbFuPFOXydiGeg9tzjNOWy9EuZUnaRt6Y9byiyrCJSKqdMzKhxfPaX92bpJa861n7Jbc9qbdmlja/nIuRYyXvinQGJXhOr4xmoUfv6+X6pDAW1g57PZSyuJzj278bo3zuklSOg9MNvQIRu3Vn1U0SKfpVBoD4vlWPRrrSdbsGEZ5sdsfBDjU/OMvdtMxTRnBAdc/S3mLgn3fuQjP/1/Cl9YAG1HyPvTcx0sp7vMzkeQdJJmQlgi7Zkt6JUhiKCUQfB+f9G0h+rVP0pJ3epn3S2OQKP/ql4Op7ZGWk/ggngyesCCjBnlsbivG+pT0W+D6jvIaj4h12/VUifR9/diJAXEUyAd4OSR1EiJ6vlQnNCaYjDKjMTrUskHhtgVElA0qZ1uWVkq1WJMDNr8IZDBZiDDEVBvBaE5+lam5FYybFusxvd+4B7WdJbpjer8fIIJmbtavsgqg9R6gAjkKFIYHYSOelUG5lOBnHsAg3qpkLNZHUOeCmbrmWmYtafKHWAKFQBxUm3+KOJ/sUFOAvruTfb2Kzap8p8/runfE84J3iLoCIqmJiROVan70OdAjh1hiJ6MDs6juZeQUd7T4SzQXjd2uds+BF+43kPwKoN7VhY9eOuHY2ukcGE9pcqVca1M5X3BNYdisgFdCSzckfukOje2d6TWC2iI6L1GyHRI8NHR+97+r3XXYlVW5wykJUuVdcOz/s31eaglM62pF3KHNUSV89WnSAcOAvLCfaCf6hyareQ8fRP7UboeWjgtm29qXPb4L7DyZy9iW4b8UVXvS9MPtRTxYEvvSj6cJ61eC+D6uN0odErykbNRI9MPXvKBPXICCiqzIWMOeC93nSf16WVAzqqBhSfj21gFh3kRdaLAdhx98e3+Vzk/ZGnzOjDy9vGFhSkYx0OAAAAAAAAAMAL+X/JDsqsuDEYXwAAAABJRU5ErkJggg==";var er="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA1CAYAAADyMeOEAAAAAXNSR0IArs4c6QAAAoVJREFUaIHdm7txwkAQhheGAqACiCHzOKQDQrqgILpwSAeEDBnEUAF0gCMxZ7G72qce/mec2Lpf9+3unaS78wgSNZ8uX5729+d1FNWXUuGmXlBOUUEIMckEpeQJgBu6C+BSFngztBR2vd+ovY+7g+p6LbgaWgJrAeUkDYIUXgXdBBwNi6kpABJwMTQH3AZsXRR8GHTfgEth8E3gjdAUcNewpbTgY85sCMCUuOokozE0YM0YRzM9NGAAXd8+omAF5h4lnmBRvpSnZHyLoLEbaN+aKB9KWv/KWw0tAbbANnlG+UvB2dm77NxxdwgBpjrF/d7rW9cbmpvio2A5z8iAYpVU8pGZlo6/2+MSco2lHfd3rv9jAP038e1xef9o2mjvYb2OqpqKE81028/jeietlSEVO5FRWsxWsJit1G3aFpW8iWe5RwpiCZAk25QvV6nz6fIlynRGuTd5WqpJ4guAlDfVKBK87hXljflgv1ON6fV+4+5gVlA17SfeG0heKqQd4l4jI/wrmaA9N9R4ar+wpHJDZyrrfcH0nB66PqAzPi76pn+faSyJk/vzOorYhGurQrzj/P68jtBMawHaHBIR9xoD5O34dy0qQOSYHvqExq2TpT2nf76+w7y251OYF0CRaU+J920TwLUa6inx6OxE6g80lu2ux7Y2eJLF/rCXE6zEPdnenk9o+4ih9AEdnW2q81HXl5LuU6OTl2fXUhqganbXAGq3g6jJOWV/OnoesO6YqqEB/GdNsjf7uHtwj2DzmRNpp7iOZfm6D9oAxB6Yi1gC4oIYeo4MIPdopEQRB+cAko5J1tW386HpB2Kz1eop4Epdwls/kgZ1sh8gZsEjdcWkr//D8Qu3Z3l5Nl1NtAAAAABJRU5ErkJggg==";var Fs={};Bn(Fs,{default:()=>$t});var $t=Ts("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L5QNSqT5iiySS9Ja2SV//5ME0ak//+4KgAAABgQBAADAMDgYCAEgCteQ0fZH6+ICXA357+MPfhR/+ywRf/U///LVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+5JknQAFoWhGLm5gBClBmT3GiAAAAAGkHAAAIAAANIOAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV");var tr="data:image/png;base64,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";var nr="data:image/png;base64,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";var Gs="3000.0.0-alpha.12",rr={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down"," ":"space"},Vs=new Set([" ","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Tab"]),ir=["left","middle","right","back","forward"],sr=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",or=0,ar=3,ks=0,Ns=3,js=-1200,_s=1200,wt="topleft",ur=64,qs="happy",vt="monospace",zs=36,cr=64,bt=1024,lr=.1,Hs=1,fr=[{name:"a_pos",size:3},{name:"a_uv",size:2},{name:"a_color",size:4}],yt=fr.reduce((i,r)=>i+r.size,0),mr=2048,hr=mr*4*yt,dr=mr*6,$s=`
attribute vec3 a_pos;
attribute vec2 a_uv;
attribute vec4 a_color;

varying vec3 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

vec4 def_vert() {
	return vec4(a_pos, 1.0);
}

{{user}}

void main() {
	vec4 pos = vert(a_pos, a_uv, a_color);
	v_pos = a_pos;
	v_uv = a_uv;
	v_color = a_color;
	gl_Position = pos;
}
`,Ys=`
precision mediump float;

varying vec3 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

uniform sampler2D u_tex;

vec4 def_frag() {
	return v_color * texture2D(u_tex, v_uv);
}

{{user}}

void main() {
	gl_FragColor = frag(v_pos, v_uv, v_color, u_tex);
	if (gl_FragColor.a == 0.0) {
		discard;
	}
}
`,Yt=`
vec4 vert(vec3 pos, vec2 uv, vec4 color) {
	return def_vert();
}
`,Xt=`
vec4 frag(vec3 pos, vec2 uv, vec4 color, sampler2D tex) {
	return def_frag();
}
`,Xs=new Set(["id","require"]),Ks=new Set(["add","update","draw","destroy","inspect","drawInspect"]);function Qs(i){i.requestFullscreen?i.requestFullscreen():i.webkitRequestFullscreen&&i.webkitRequestFullscreen()}u(Qs,"enterFullscreen");function Js(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullScreen&&document.webkitExitFullScreen()}u(Js,"exitFullscreen");function Zs(){return document.fullscreenElement||document.webkitFullscreenElement}u(Zs,"getFullscreenElement");function nt(i){switch(i){case"topleft":return p(-1,-1);case"top":return p(0,-1);case"topright":return p(1,-1);case"left":return p(-1,0);case"center":return p(0,0);case"right":return p(1,0);case"botleft":return p(-1,1);case"bot":return p(0,1);case"botright":return p(1,1);default:return i}}u(nt,"anchorPt");function Ws(i){switch(i){case"left":return 0;case"center":return .5;case"right":return 1;default:return 0}}u(Ws,"alignPt");function Kt(i){return i.createBuffer(1,1,44100)}u(Kt,"createEmptyAudioBuffer");var He=class{pressed=new Set([]);pressedRepeat=new Set([]);released=new Set([]);down=new Set([]);update(){this.pressed.clear(),this.released.clear(),this.pressedRepeat.clear()}press(r){this.pressed.add(r),this.pressedRepeat.add(r),this.down.add(r)}pressRepeat(r){this.pressedRepeat.add(r)}release(r){this.down.delete(r),this.pressed.delete(r),this.released.add(r)}};u(He,"ButtonState");var eo=u((i={})=>{let r=[],a=(()=>{let e=i.root??document.body;e===document.body&&(document.body.style.width="100%",document.body.style.height="100%",document.body.style.margin="0px",document.documentElement.style.width="100%",document.documentElement.style.height="100%");let t=i.canvas??(()=>{let b=document.createElement("canvas");return e.appendChild(b),b})(),n=i.scale??1,s=!(i.width&&i.height&&!i.stretch&&!i.letterbox),h=t.parentElement.offsetWidth,o=t.parentElement.offsetHeight;s?(t.width=h,t.height=o):(t.width=i.width*n,t.height=i.height*n);let l=t.width,d=t.height,m=i.pixelDensity||window.devicePixelRatio;t.width*=m,t.height*=m;let w=[`width: ${l}px`,`height: ${d}px`,"outline: none","cursor: default"];return i.crisp&&(w.push("image-rendering: pixelated"),w.push("image-rendering: crisp-edges")),t.style.cssText=w.join(";"),t.tabIndex=0,{canvas:t,canvas2:t.cloneNode(),pixelDensity:m,stretchToParent:s,lastParentWidth:h,lastParentHeight:o,keyState:new He,mouseState:new He,virtualButtonState:new He,charInputted:[],isMouseMoved:!1,mouseStarted:!1,mousePos:p(0,0),mouseDeltaPos:p(0,0),time:0,realTime:0,skipTime:!1,dt:0,numFrames:0,isTouchScreen:"ontouchstart"in window||navigator.maxTouchPoints>0,loopID:null,stopped:!1,paused:!1,fpsCounter:new ze}})(),c=a.canvas.getContext("webgl",{antialias:!0,depth:!0,stencil:!0,alpha:!0,preserveDrawingBuffer:!0});class v{src=null;glTex;width;height;constructor(t,n,s={}){this.glTex=c.createTexture(),r.push(()=>this.free()),this.bind(),t&&n&&c.texImage2D(c.TEXTURE_2D,0,c.RGBA,t,n,0,c.RGBA,c.UNSIGNED_BYTE,null),this.width=t,this.height=n;let h=(()=>{switch(s.filter??i.texFilter){case"linear":return c.LINEAR;case"nearest":return c.NEAREST;default:return c.NEAREST}})(),o=(()=>{switch(s.wrap){case"repeat":return c.REPEAT;case"clampToEdge":return c.CLAMP_TO_EDGE;default:return c.CLAMP_TO_EDGE}})();c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,h),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,h),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,o),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,o),this.unbind()}static fromImage(t,n={}){let s=new v(0,0,n);return s.bind(),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,t),s.width=t.width,s.height=t.height,s.unbind(),s.src=t,s}update(t,n,s){this.bind(),c.texSubImage2D(c.TEXTURE_2D,0,t,n,c.RGBA,c.UNSIGNED_BYTE,s),this.unbind()}bind(){c.bindTexture(c.TEXTURE_2D,this.glTex)}unbind(){c.bindTexture(c.TEXTURE_2D,null)}free(){c.deleteTexture(this.glTex)}}u(v,"Texture");let g=(()=>{let e=xt(Yt,Xt),t=v.fromImage(new ImageData(new Uint8ClampedArray([255,255,255,255]),1,1));if(i.background){let o=E.fromArray(i.background);c.clearColor(o.r/255,o.g/255,o.b/255,i.background[3]??1)}c.enable(c.BLEND),c.enable(c.SCISSOR_TEST),c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);let n=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,n),c.bufferData(c.ARRAY_BUFFER,hr*4,c.DYNAMIC_DRAW),fr.reduce((o,l,d)=>(c.vertexAttribPointer(d,l.size,c.FLOAT,!1,yt*4,o),c.enableVertexAttribArray(d),o+l.size*4),0),c.bindBuffer(c.ARRAY_BUFFER,null);let s=c.createBuffer();c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,s),c.bufferData(c.ELEMENT_ARRAY_BUFFER,dr*4,c.DYNAMIC_DRAW),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,null);let h=v.fromImage(new ImageData(new Uint8ClampedArray([128,128,128,255,190,190,190,255,190,190,190,255,128,128,128,255]),2,2),{wrap:"repeat",filter:"nearest"});return{drawCalls:0,lastDrawCalls:0,defShader:e,curShader:e,defTex:t,curTex:t,curUniform:{},vbuf:n,ibuf:s,vqueue:[],iqueue:[],transform:new A,transformStack:[],bgTex:h,width:i.width,height:i.height,viewport:{x:0,y:0,width:c.drawingBufferWidth,height:c.drawingBufferHeight}}})();class T{tex;frames=[new N(0,0,1,1)];anims={};constructor(t,n,s={}){this.tex=t,n&&(this.frames=n),this.anims=s}static from(t,n={}){return typeof t=="string"?T.fromURL(t,n):Promise.resolve(T.fromImage(t,n))}static fromImage(t,n={}){return new T(v.fromImage(t,n),Ae(n.sliceX||1,n.sliceY||1),n.anims??{})}static fromURL(t,n={}){return Ce(t).then(s=>T.fromImage(s,n))}}u(T,"SpriteData");class R{buf;constructor(t){this.buf=t}static fromArrayBuffer(t){return new Promise((n,s)=>C.ctx.decodeAudioData(t,n,s)).then(n=>new R(n))}static fromURL(t){return Ht(t)?R.fromArrayBuffer(Qn(t)):it(t).then(n=>R.fromArrayBuffer(n))}}u(R,"SoundData");let C=(()=>{let e=new(window.AudioContext||window.webkitAudioContext),t=e.createGain();t.connect(e.destination);let n=new R(Kt(e));return e.decodeAudioData($t.buffer.slice(0)).then(s=>{n.buf=s}).catch(s=>{console.error("Failed to load burp: ",s)}),{ctx:e,masterNode:t,burpSnd:n}})();class O{done=!1;data=null;error=null;onLoadEvents=new W;onErrorEvents=new W;onFinishEvents=new W;constructor(t){t.then(n=>{this.data=n,this.onLoadEvents.trigger(n)}).catch(n=>{if(this.error=n,this.onErrorEvents.numListeners()>0)this.onErrorEvents.trigger(n);else throw n}).finally(()=>{this.onFinishEvents.trigger(),this.done=!0})}static loaded(t){let n=new O(Promise.resolve(t));return n.data=t,n.done=!0,n}onLoad(t){return this.onLoadEvents.add(t),this}onError(t){return this.onErrorEvents.add(t),this}onFinish(t){return this.onFinishEvents.add(t),this}then(t){return this.onLoad(t)}catch(t){return this.onError(t)}finally(t){return this.onFinish(t)}}u(O,"Asset");class M{assets=new Map;lastUID=0;add(t,n){let s=t??this.lastUID+++"",h=new O(n);return this.assets.set(s,h),h}addLoaded(t,n){let s=t??this.lastUID+++"",h=O.loaded(n);this.assets.set(s,h)}get(t){return this.assets.get(t)}progress(){if(this.assets.size===0)return 1;let t=0;return this.assets.forEach(n=>{n.done&&t++}),t/this.assets.size}}u(M,"AssetBucket");let U={urlPrefix:"",sprites:new M,fonts:new M,bitmapFonts:new M,sounds:new M,shaders:new M,custom:new M,loaded:!1},f={ev:new oe,objEvents:new oe,root:vn([]),gravity:0,scenes:{},logs:[],cam:{pos:null,scale:p(1),angle:0,shake:0,transform:new A}};function ue(e){return U.custom.add(null,e)}u(ue,"load");function I(){let e=[U.sprites,U.sounds,U.shaders,U.fonts,U.bitmapFonts,U.custom];return e.reduce((t,n)=>t+n.progress(),0)/e.length}u(I,"loadProgress");function Y(e){return e!==void 0&&(U.urlPrefix=e),U.urlPrefix}u(Y,"loadRoot");function Ee(e){let t=U.urlPrefix+e;return fetch(t).then(n=>{if(!n.ok)throw new Error(`Failed to fetch ${t}`);return n})}u(Ee,"fetchURL");function Se(e){return Ee(e).then(t=>t.json())}u(Se,"fetchJSON");function rt(e){return Ee(e).then(t=>t.text())}u(rt,"fetchText");function it(e){return Ee(e).then(t=>t.arrayBuffer())}u(it,"fetchArrayBuffer");function Ce(e){let t=new Image;return t.crossOrigin="anonymous",t.src=Ht(e)?e:U.urlPrefix+e,new Promise((n,s)=>{t.onload=()=>n(t),t.onerror=()=>s(new Error(`Failed to load image from "${e}"`))})}u(Ce,"loadImg");function Ut(e,t){let n=new FontFace(e,typeof t=="string"?`url(${t})`:t);return document.fonts.add(n),U.fonts.add(e,n.load().catch(()=>{throw new Error(`Failed to load font from "${t}"`)}))}u(Ut,"loadFont");function Te(e,t,n,s,h={}){return U.bitmapFonts.add(e,Ce(t).then(o=>Sr(v.fromImage(o,h),n,s,h.chars??sr)))}u(Te,"loadBitmapFont");function Ae(e=1,t=1,n=0,s=0,h=1,o=1){let l=[],d=h/e,m=o/t;for(let w=0;w<t;w++)for(let b=0;b<e;b++)l.push(new N(n+b*d,s+w*m,d,m));return l}u(Ae,"slice");function Qt(e,t){return ue(typeof t=="string"?new Promise((n,s)=>{Se(t).then(h=>{Qt(e,h).then(n).catch(s)})}):T.from(e).then(n=>{let s={};for(let h in t){let o=n.tex.width,l=n.tex.height,d=t[h],m=new T(n.tex,Ae(d.sliceX,d.sliceY,d.x/o,d.y/l,d.width/o,d.height/l),d.anims);U.sprites.addLoaded(h,m),s[h]=m}return s}))}u(Qt,"loadSpriteAtlas");function Oe(e,t,n={sliceX:1,sliceY:1,anims:{}}){return U.sprites.add(e,typeof t=="string"?T.fromURL(t,n):Promise.resolve(T.fromImage(t,n)))}u(Oe,"loadSprite");function pr(e,t){return U.sprites.add(e,new Promise(async n=>{let s=typeof t=="string"?await Se(t):t,h=await Promise.all(s.frames.map(Ce)),o=document.createElement("canvas");o.width=s.width,o.height=s.height*s.frames.length;let l=o.getContext("2d");h.forEach((m,w)=>{l.drawImage(m,0,w*s.height)});let d=await Oe(null,o,{sliceY:s.frames.length,anims:s.anims});n(d)}))}u(pr,"loadPedit");function gr(e,t,n){return U.sprites.add(e,new Promise(async s=>{let h=await Oe(null,t),o=typeof n=="string"?await Se(n):n,l=o.meta.size;h.frames=o.frames.map(d=>new N(d.frame.x/l.w,d.frame.y/l.h,d.frame.w/l.w,d.frame.h/l.h));for(let d of o.meta.frameTags)d.from===d.to?h.anims[d.name]=d.from:h.anims[d.name]={from:d.from,to:d.to,speed:10,loop:!0,pingpong:d.direction==="pingpong"};s(h)}))}u(gr,"loadAseprite");function wr(e,t,n,s=!1){return U.shaders.add(e,new Promise((h,o)=>{let l=u(d=>d?rt(d):new Promise(m=>m(null)),"resolveUrl");if(s)Promise.all([l(t),l(n)]).then(([d,m])=>{h(xt(d,m))}).catch(o);else try{h(xt(t,n))}catch(d){o(d)}}))}u(wr,"loadShader");function vr(e,t){return U.sounds.add(e,typeof t=="string"?R.fromURL(t):R.fromArrayBuffer(t))}u(vr,"loadSound");function br(e="bean"){return Oe(e,er)}u(br,"loadBean");function Jt(e){return U.sprites.get(e)}u(Jt,"getSprite");function Zt(e){return U.sounds.get(e)}u(Zt,"getSound");function yr(e){return U.fonts.get(e)}u(yr,"getFont");function Wt(e){return U.bitmapFonts.get(e)}u(Wt,"getBitmapFont");function en(e){return U.shaders.get(e)}u(en,"getShader");function tn(e){if(typeof e=="string"){let t=Jt(e);if(t)return t;if(I()<1)return null;throw new Error(`Sprite not found: ${e}`)}else{if(e instanceof T)return O.loaded(e);if(e instanceof O)return e;throw new Error(`Invalid sprite: ${e}`)}}u(tn,"resolveSprite");function Ur(e){if(typeof e=="string"){let t=Zt(e);if(t)return t.data?t.data:t;if(I()<1)return null;throw new Error(`Sound not found: ${e}`)}else{if(e instanceof R)return e;if(e instanceof O)return e.data?e.data:e;throw new Error(`Invalid sound: ${e}`)}}u(Ur,"resolveSound");function xr(e){if(!e)return g.defShader;if(typeof e=="string"){let t=en(e);if(t)return t.data?t.data:t;if(I()<1)return null;throw new Error(`Shader not found: ${e}`)}else if(e instanceof O)return e.data?e.data:e;return e}u(xr,"resolveShader");function nn(e){if(!e)return nn(i.font??qs);if(typeof e=="string"){let t=Wt(e);if(t)return t.data?t.data:t;if(document.fonts.check(`${cr}px ${e}`))return e;if(I()<1)return null;throw new Error(`Font not found: ${e}`)}else if(e instanceof O)return e.data?e.data:e;return e}u(nn,"resolveFont");function Er(e){return e!==void 0&&(C.masterNode.gain.value=te(e,or,ar)),C.masterNode.gain.value}u(Er,"volume");function $e(e,t={loop:!1,volume:1,speed:1,detune:0,seek:0}){let n=Ur(e);if(n instanceof O){let y=$e(new R(Kt(C.ctx))),L=u(P=>{let q=$e(P,t);for(let z in q)y[z]=q[z]},"doPlay");return n.onLoad(L),y}else if(n===null){let y=$e(new R(Kt(C.ctx)));return Bt(()=>{}),y}let s=C.ctx,h=!1,o=s.createBufferSource();o.buffer=n.buf,o.loop=!!t.loop;let l=s.createGain();o.connect(l),l.connect(C.masterNode);let d=t.seek??0;o.start(0,d);let m=s.currentTime-d,w=null,b={stop(){h||(this.pause(),m=s.currentTime)},play(y){if(!h)return;let L=o;o=s.createBufferSource(),o.buffer=L.buffer,o.loop=L.loop,o.playbackRate.value=L.playbackRate.value,o.detune&&(o.detune.value=L.detune.value),o.connect(l);let P=y??this.time();o.start(0,P),m=s.currentTime-P,h=!1,w=null},pause(){h||(o.stop(),h=!0,w=s.currentTime)},isPaused(){return h},isStopped(){return h},speed(y){return y!==void 0&&(o.playbackRate.value=te(y,ks,Ns)),o.playbackRate.value},detune(y){return o.detune?(y!==void 0&&(o.detune.value=te(y,js,_s)),o.detune.value):0},volume(y){return y!==void 0&&(l.gain.value=te(y,or,ar)),l.gain.value},loop(){o.loop=!0},unloop(){o.loop=!1},duration(){return n.buf.duration},time(){return h?w-m:s.currentTime-m}};return b.speed(t.speed),b.detune(t.detune),b.volume(t.volume),b}u($e,"play");function rn(e){return $e(C.burpSnd,e)}u(rn,"burp");function xt(e=Yt,t=Xt){let n=$s.replace("{{user}}",e??Yt),s=Ys.replace("{{user}}",t??Xt),h=c.createShader(c.VERTEX_SHADER),o=c.createShader(c.FRAGMENT_SHADER);c.shaderSource(h,n),c.shaderSource(o,s),c.compileShader(h),c.compileShader(o);let l=c.createProgram();if(r.push(()=>c.deleteProgram(l)),c.attachShader(l,h),c.attachShader(l,o),c.bindAttribLocation(l,0,"a_pos"),c.bindAttribLocation(l,1,"a_uv"),c.bindAttribLocation(l,2,"a_color"),c.linkProgram(l),!c.getProgramParameter(l,c.LINK_STATUS)){let d=u(y=>{let L=/^ERROR:\s0:(?<line>\d+):\s(?<msg>.+)/,P=y.match(L);return{line:Number(P.groups.line),msg:P.groups.msg.replace(/\n\0$/,"")}},"formatShaderError"),m=c.getShaderInfoLog(h),w=c.getShaderInfoLog(o),b="";if(m){let y=d(m);b+=`Vertex shader line ${y.line-14}: ${y.msg}`}if(w){let y=d(w);b+=`Fragment shader line ${y.line-14}: ${y.msg}`}throw new Error(b)}return c.deleteShader(h),c.deleteShader(o),{bind(){c.useProgram(l)},unbind(){c.useProgram(null)},free(){c.deleteProgram(l)},send(d){for(let m in d){let w=d[m],b=c.getUniformLocation(l,m);typeof w=="number"?c.uniform1f(b,w):w instanceof A?c.uniformMatrix4fv(b,!1,new Float32Array(w.m)):w instanceof E?c.uniform3f(b,w.r,w.g,w.b):w instanceof ke?c.uniform3f(b,w.x,w.y,w.z):w instanceof D&&c.uniform2f(b,w.x,w.y)}}}}u(xt,"makeShader");function Sr(e,t,n,s){let h=e.width/t,o={},l=s.split("").entries();for(let[d,m]of l)o[m]=new N(d%h*t,Math.floor(d/h)*n,t,n);return{tex:e,map:o,size:n}}u(Sr,"makeFont");function Et(e,t,n,s=g.defTex,h=g.defShader,o={}){let l=xr(h);if(!(!l||l instanceof O)){(s!==g.curTex||l!==g.curShader||!_t(g.curUniform,o)||g.vqueue.length+e.length*yt>hr||g.iqueue.length+t.length>dr)&&ce();for(let d of e){let m=n?g.transform:f.cam.transform.mult(g.transform),w=Ar(m.multVec2(d.pos.xy()));g.vqueue.push(w.x,w.y,d.pos.z,d.uv.x,d.uv.y,d.color.r/255,d.color.g/255,d.color.b/255,d.opacity)}for(let d of t)g.iqueue.push(d+g.vqueue.length/yt-e.length);g.curTex=s,g.curShader=l,g.curUniform=o}}u(Et,"drawRaw");function ce(){!g.curTex||!g.curShader||g.vqueue.length===0||g.iqueue.length===0||(c.bindBuffer(c.ARRAY_BUFFER,g.vbuf),c.bufferSubData(c.ARRAY_BUFFER,0,new Float32Array(g.vqueue)),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,g.ibuf),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,new Uint16Array(g.iqueue)),g.curShader.bind(),g.curShader.send(g.curUniform),g.curTex.bind(),c.drawElements(c.TRIANGLES,g.iqueue.length,c.UNSIGNED_SHORT,0),g.curTex.unbind(),g.curShader.unbind(),c.bindBuffer(c.ARRAY_BUFFER,null),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,null),g.vqueue=[],g.iqueue=[],g.drawCalls++)}u(ce,"flush");function Cr(){Ir(),c.clear(c.COLOR_BUFFER_BIT),i.background||ae(()=>{Re({width:j(),height:B(),quad:new N(0,0,j()/ur,B()/ur),tex:g.bgTex,fixed:!0})}),g.drawCalls=0,g.transformStack=[],g.transform=new A}u(Cr,"frameStart");function Tr(){ce(),g.lastDrawCalls=g.drawCalls}u(Tr,"frameEnd");function Ar(e){return p(e.x/j()*2-1,-e.y/B()*2+1)}u(Ar,"screen2ndc");function Or(e){g.transform=e.clone()}u(Or,"pushMatrix");function G(...e){if(e[0]===void 0)return;let t=p(...e);t.x===0&&t.y===0||(g.transform=g.transform.translate(t))}u(G,"pushTranslate");function Pe(...e){if(e[0]===void 0)return;let t=p(...e);t.x===1&&t.y===1||(g.transform=g.transform.scale(t))}u(Pe,"pushScale");function Pr(e){!e||(g.transform=g.transform.rotateX(e))}u(Pr,"pushRotateX");function Rr(e){!e||(g.transform=g.transform.rotateY(e))}u(Rr,"pushRotateY");function ge(e){!e||(g.transform=g.transform.rotateZ(e))}u(ge,"pushRotateZ");let Dr=ge;function ee(){g.transformStack.push(g.transform.clone())}u(ee,"pushTransform");function X(){g.transformStack.length>0&&(g.transform=g.transformStack.pop())}u(X,"popTransform");function Re(e){if(e.width===void 0||e.height===void 0)throw new Error('drawUVQuad() requires property "width" and "height".');if(e.width<=0||e.height<=0)return;let t=e.width,n=e.height,h=nt(e.anchor||wt).scale(p(t,n).scale(-.5)),o=e.quad||new N(0,0,1,1),l=e.color||x(255,255,255),d=e.opacity??1,m=e.tex?lr/e.tex.width:0,w=e.tex?lr/e.tex.height:0,b=o.x+m,y=o.y+w,L=o.w-m*2,P=o.h-w*2;ee(),G(e.pos),ge(e.angle),Pe(e.scale),G(h),Et([{pos:me(-t/2,n/2,0),uv:p(e.flipX?b+L:b,e.flipY?y:y+P),color:l,opacity:d},{pos:me(-t/2,-n/2,0),uv:p(e.flipX?b+L:b,e.flipY?y+P:y),color:l,opacity:d},{pos:me(t/2,-n/2,0),uv:p(e.flipX?b:b+L,e.flipY?y+P:y),color:l,opacity:d},{pos:me(t/2,n/2,0),uv:p(e.flipX?b:b+L,e.flipY?y:y+P),color:l,opacity:d}],[0,1,3,1,2,3],e.fixed,e.tex,e.shader,e.uniform),X()}u(Re,"drawUVQuad");function Mr(e){if(!e.tex)throw new Error('drawTexture() requires property "tex".');let t=e.quad??new N(0,0,1,1),n=e.tex.width*t.w,s=e.tex.height*t.h,h=p(1);if(e.tiled){let o=Math.ceil((e.width||n)/n),l=Math.ceil((e.height||s)/s),m=nt(e.anchor||wt).add(p(1,1)).scale(.5).scale(o*n,l*s);for(let w=0;w<o;w++)for(let b=0;b<l;b++)Re({...e,pos:(e.pos||p(0)).add(p(n*w,s*b)).sub(m),scale:h.scale(e.scale||p(1)),tex:e.tex,quad:t,width:n,height:s,anchor:"topleft"})}else e.width&&e.height?(h.x=e.width/n,h.y=e.height/s):e.width?(h.x=e.width/n,h.y=h.x):e.height&&(h.y=e.height/s,h.x=h.y),Re({...e,scale:h.scale(e.scale||p(1)),tex:e.tex,quad:t,width:n,height:s})}u(Mr,"drawTexture");function sn(e){if(!e.sprite)throw new Error('drawSprite() requires property "sprite"');let t=tn(e.sprite);if(!t||!t.data)return;let n=t.data.frames[e.frame??0];if(!n)throw new Error(`Frame not found: ${e.frame??0}`);Mr({...e,tex:t.data.tex,quad:n.scale(e.quad||new N(0,0,1,1))})}u(sn,"drawSprite");function Ye(e,t,n,s,h,o=1){s=he(s%360),h=he(h%360),h<=s&&(h+=Math.PI*2);let l=Math.ceil(Math.max(Math.sqrt(t+n)*3*(o||1),16)),d=(h-s)/l,m=[];for(let w=s;w<h;w+=d)m.push(e.add(t*Math.cos(w),n*Math.sin(w)));return m.push(e.add(t*Math.cos(h),n*Math.sin(h))),m}u(Ye,"getArcPts");function K(e){if(e.width===void 0||e.height===void 0)throw new Error('drawRect() requires property "width" and "height".');if(e.width<=0||e.height<=0)return;let t=e.width,n=e.height,h=nt(e.anchor||wt).add(1,1).scale(p(t,n).scale(-.5)),o=[p(0,0),p(t,0),p(t,n),p(0,n)];if(e.radius){let l=Math.min(Math.min(t,n)/2,e.radius);o=[p(l,0),p(t-l,0),...Ye(p(t-l,l),l,l,270,360),p(t,l),p(t,n-l),...Ye(p(t-l,n-l),l,l,0,90),p(t-l,n),p(l,n),...Ye(p(l,n-l),l,l,90,180),p(0,n-l),p(0,l),...Ye(p(l,l),l,l,180,270)]}ve({...e,offset:h,pts:o,...e.gradient?{colors:e.horizontal?[e.gradient[0],e.gradient[1],e.gradient[1],e.gradient[0]]:[e.gradient[0],e.gradient[0],e.gradient[1],e.gradient[1]]}:{}})}u(K,"drawRect");function Xe(e){let{p1:t,p2:n}=e;if(!t||!n)throw new Error('drawLine() requires properties "p1" and "p2".');let s=e.width||1,h=n.sub(t).unit().normal().scale(s*.5),o=[t.sub(h),t.add(h),n.add(h),n.sub(h)].map(l=>({pos:me(l.x,l.y,0),uv:p(0),color:e.color??E.WHITE,opacity:e.opacity??1}));Et(o,[0,1,3,1,2,3],e.fixed,g.defTex,e.shader,e.uniform)}u(Xe,"drawLine");function on(e){let t=e.pts;if(!t)throw new Error('drawLines() requires property "pts".');if(!(t.length<2))if(e.radius&&t.length>=3){let n=t[0].dist(t[1]);for(let h=1;h<t.length-1;h++)n=Math.min(t[h].dist(t[h+1]),n);let s=Math.min(e.radius,n/2);Xe({...e,p1:t[0],p2:t[1]});for(let h=1;h<t.length-2;h++){let o=t[h],l=t[h+1];Xe({...e,p1:o,p2:l})}Xe({...e,p1:t[t.length-2],p2:t[t.length-1]})}else for(let n=0;n<t.length-1;n++)Xe({...e,p1:t[n],p2:t[n+1]}),e.join!=="none"&&we({...e,pos:t[n],radius:e.width/2})}u(on,"drawLines");function an(e){if(!e.p1||!e.p2||!e.p3)throw new Error('drawPolygon() requires properties "p1", "p2" and "p3".');return ve({...e,pts:[e.p1,e.p2,e.p3]})}u(an,"drawTriangle");function we(e){if(!e.radius)throw new Error('drawCircle() requires property "radius".');e.radius!==0&&un({...e,radiusX:e.radius,radiusY:e.radius,angle:0})}u(we,"drawCircle");function un(e){if(e.radiusX===void 0||e.radiusY===void 0)throw new Error('drawEllipse() requires properties "radiusX" and "radiusY".');if(e.radiusX===0||e.radiusY===0)return;let t=e.start??0,n=e.end??360,s=Ye(p(0),e.radiusX,e.radiusY,t,n,e.resolution);s.unshift(p(0));let h={...e,pts:s,radius:0,...e.gradient?{colors:[e.gradient[0],...Array(s.length-1).fill(e.gradient[1])]}:{}};if(n-t>=360&&e.outline){e.fill!==!1&&ve({...h,outline:null}),ve({...h,pts:s.slice(1),fill:!1});return}ve(h)}u(un,"drawEllipse");function ve(e){if(!e.pts)throw new Error('drawPolygon() requires property "pts".');let t=e.pts.length;if(!(t<3)){if(ee(),G(e.pos),Pe(e.scale),ge(e.angle),G(e.offset),e.fill!==!1){let n=e.color??E.WHITE,s=e.pts.map((o,l)=>({pos:me(o.x,o.y,0),uv:p(0,0),color:e.colors?e.colors[l]??n:n,opacity:e.opacity??1})),h=[...Array(t-2).keys()].map(o=>[0,o+1,o+2]).flat();Et(s,e.indices??h,e.fixed,g.defTex,e.shader,e.uniform)}e.outline&&on({pts:[...e.pts,e.pts[0]],radius:e.radius,width:e.outline.width,color:e.outline.color,join:e.outline.join,uniform:e.uniform,fixed:e.fixed,opacity:e.opacity}),X()}}u(ve,"drawPolygon");function cn(e,t,n){ce(),c.clear(c.STENCIL_BUFFER_BIT),c.enable(c.STENCIL_TEST),c.stencilFunc(c.NEVER,1,255),c.stencilOp(c.REPLACE,c.REPLACE,c.REPLACE),t(),ce(),c.stencilFunc(n,1,255),c.stencilOp(c.KEEP,c.KEEP,c.KEEP),e(),ce(),c.disable(c.STENCIL_TEST)}u(cn,"drawStenciled");function Fr(e,t){cn(e,t,c.EQUAL)}u(Fr,"drawMasked");function Br(e,t){cn(e,t,c.NOTEQUAL)}u(Br,"drawSubtracted");function ln(){return(g.viewport.width+g.viewport.height)/(g.width+g.height)}u(ln,"getViewportScale");function ae(e){ce();let t=g.width,n=g.height;g.width=g.viewport.width,g.height=g.viewport.height,e(),ce(),g.width=t,g.height=n}u(ae,"drawUnscaled");function hn(e,t){t.pos&&(e.pos=e.pos.add(t.pos)),t.scale&&(e.scale=e.scale.scale(p(t.scale))),t.angle&&(e.angle+=t.angle),t.color&&(e.color=e.color.mult(t.color)),t.opacity&&(e.opacity*=t.opacity)}u(hn,"applyCharTransform");let dn=/\[(?<text>[^\]]*)\]\.(?<style>[\w\.]+)+/g;function Lr(e){let t={},n=e.replace(dn,"$1"),s=0;for(let h of e.matchAll(dn)){let o=h.groups.style.split("."),l=h.index-s;for(let d=l;d<h.index+h.groups.text.length;d++)t[d]={localIdx:d-l,styles:o};s+=3+h.groups.style.length}return{charStyleMap:t,text:n}}u(Lr,"compileStyledText");let St={};function be(e){if(e.text===void 0)throw new Error('formatText() requires property "text".');let t=nn(e.font);if(e.text===""||t instanceof O||!t)return{width:0,height:0,chars:[],opt:e};let{charStyleMap:n,text:s}=Lr(e.text+""),h=s.split("");if(t instanceof FontFace||typeof t=="string"){let _=t instanceof FontFace?t.family:t,S=St[_]??{font:{tex:new v(bt,bt,{filter:"linear"}),map:{},size:cr},cursor:p(0)};St[_]||(St[_]=S),t=S.font;for(let k of h)if(!S.font.map[k]){let ne=a.canvas2.getContext("2d");ne.font=`${t.size}px ${_}`,ne.clearRect(0,0,a.canvas2.width,a.canvas2.height),ne.textBaseline="top",ne.textAlign="left",ne.fillStyle="rgb(255, 255, 255)",ne.fillText(k,0,0);let We=ne.measureText(k),Ie=Math.ceil(We.width),Ge=ne.getImageData(0,0,Ie,t.size);if(S.cursor.x+Ie>bt&&(S.cursor.x=0,S.cursor.y+=t.size,S.cursor.y>bt))throw new Error("Font atlas exceeds character limit");t.tex.update(S.cursor.x,S.cursor.y,Ge),t.map[k]=new N(S.cursor.x,S.cursor.y,Ie,t.size),S.cursor.x+=Ie}}let o=e.size||t.size,l=p(e.scale??1).scale(o/t.size),d=e.lineSpacing??0,m=e.letterSpacing??0,w=0,b=0,y=0,L=[],P=[],q=0,z=null,Ue=null;for(;q<h.length;){let _=h[q];if(_===`
`)y+=o+d,L.push({width:w-m,chars:P}),z=null,Ue=null,w=0,P=[];else{let S=t.map[_];if(S){let k=S.w*l.x;e.width&&w+k>e.width&&(y+=o+d,z!=null&&(q-=P.length-z,_=h[q],S=t.map[_],k=S.w*l.x,P=P.slice(0,z-1),w=Ue),z=null,Ue=null,L.push({width:w-m,chars:P}),w=0,P=[]),P.push({tex:t.tex,width:S.w,height:S.h,quad:new N(S.x/t.tex.width,S.y/t.tex.height,S.w/t.tex.width,S.h/t.tex.height),ch:_,pos:p(w,y),opacity:e.opacity??1,color:e.color??E.WHITE,scale:p(l),angle:0}),_===" "&&(z=P.length,Ue=w),w+=k,b=Math.max(b,w),w+=m}}q++}L.push({width:w-m,chars:P}),y+=o,e.width&&(b=e.width);let J=[];for(let _ of L){let S=(b-_.width)*Ws(e.align??"left");for(let k of _.chars){let ne=t.map[k.ch],We=J.length,Ie=new D(ne.w*l.x*.5,ne.h*l.y*.5);if(k.pos=k.pos.add(S,0).add(Ie),e.transform){let Ge=typeof e.transform=="function"?e.transform(We,k.ch):e.transform;Ge&&hn(k,Ge)}if(n[We]){let{styles:Ge,localIdx:vs}=n[We];for(let bs of Ge){let Gt=e.styles[bs],Fn=typeof Gt=="function"?Gt(vs,k.ch):Gt;Fn&&hn(k,Fn)}}J.push(k)}}return{width:b,height:y,chars:J,opt:e}}u(be,"formatText");function st(e){ye(be(e))}u(st,"drawText");function ye(e){ee(),G(e.opt.pos),ge(e.opt.angle),G(nt(e.opt.anchor??"topleft").add(1,1).scale(e.width,e.height).scale(-.5)),e.chars.forEach(t=>{Re({tex:t.tex,width:t.width,height:t.height,pos:t.pos,scale:t.scale,angle:t.angle,color:t.color,opacity:t.opacity,quad:t.quad,anchor:"center",uniform:e.opt.uniform,shader:e.opt.shader,fixed:e.opt.fixed})}),X()}u(ye,"drawFormattedText");function Ir(){if(a.stretchToParent&&!Ot()){let h=a.canvas.parentElement.offsetWidth,o=a.canvas.parentElement.offsetHeight;if(h!==a.lastParentWidth||o!==a.lastParentHeight){a.canvas.width=h*a.pixelDensity,a.canvas.height=o*a.pixelDensity,a.canvas.style.width=h+"px",a.canvas.style.height=o+"px";let l=j(),d=B();f.ev.onOnce("frameEnd",()=>{f.ev.trigger("resize",l,d,j(),B())})}a.lastParentWidth=h,a.lastParentHeight=o}let e=a.pixelDensity,t=c.drawingBufferWidth/e,n=c.drawingBufferHeight/e;if(Ot()){let h=window.innerWidth,o=window.innerHeight,l=h/o,d=t/n;if(l>d){let m=window.innerHeight*d;g.viewport={x:(h-m)/2,y:0,width:m,height:o}}else{let m=window.innerWidth/d;g.viewport={x:0,y:(o-m)/2,width:h,height:m}}return}if(i.letterbox){if(!i.width||!i.height)throw new Error("Letterboxing requires width and height defined.");let h=t/n,o=i.width/i.height;if(h>o){i.stretch||(g.width=n*o,g.height=n);let l=n*o,d=n,m=(t-l)/2;c.scissor(m*e,0,l*e,d*e),c.viewport(m*e,0,l*e,n*e),g.viewport={x:m,y:0,width:l,height:n}}else{i.stretch||(g.width=t,g.height=t/o);let l=t,d=t/o,m=(n-d)/2;c.scissor(0,m*e,l*e,d*e),c.viewport(0,m*e,t*e,d*e),g.viewport={x:0,y:m,width:t,height:d}}return}if(i.stretch){if(!i.width||!i.height)throw new Error("Stretching requires width and height defined.");c.viewport(0,0,t*e,n*e),g.viewport={x:0,y:0,width:t,height:n};return}let s=i.scale??1;g.width=t/s,g.height=n/s,c.viewport(0,0,t*e,n*e),g.viewport={x:0,y:0,width:t,height:n}}u(Ir,"updateViewport");function j(){return g.width}u(j,"width");function B(){return g.height}u(B,"height");let $={},Ke={},De={};function Qe(e){return p((e.x-g.viewport.x)*j()/g.viewport.width,(e.y-g.viewport.y)*B()/g.viewport.height)}u(Qe,"windowToContent");function Gr(e){return p(e.x*g.viewport.width/g.width,e.y*g.viewport.height/g.height)}u(Gr,"contentToView");function Ct(e,t){let n=Qe(p(e,t));a.mouseStarted&&(a.mouseDeltaPos=n.sub(a.mousePos)),a.mousePos=n,a.mouseStarted=!0,a.isMouseMoved=!0}u(Ct,"setMousePos"),$.mousemove=e=>{f.ev.onOnce("input",()=>{Ct(e.offsetX,e.offsetY),f.ev.trigger("mouseMove")})},$.mousedown=e=>{f.ev.onOnce("input",()=>{let t=ir[e.button];t&&a.mouseState.press(t),f.ev.trigger("mousePress",t)})},$.mouseup=e=>{f.ev.onOnce("input",()=>{let t=ir[e.button];t&&a.mouseState.release(t),f.ev.trigger("mouseRelease",t)})},$.keydown=e=>{Vs.has(e.key)&&e.preventDefault(),f.ev.onOnce("input",()=>{let t=rr[e.key]||e.key.toLowerCase();t.length===1?(f.ev.trigger("charInput",t),a.charInputted.push(t)):t==="space"&&(f.ev.trigger("charInput"," "),a.charInputted.push(" ")),e.repeat?(a.keyState.pressRepeat(t),f.ev.trigger("keyPressRepeat",t)):(a.keyState.press(t),f.ev.trigger("keyPressRepeat",t),f.ev.trigger("keyPress",t))})},$.keyup=e=>{f.ev.onOnce("input",()=>{let t=rr[e.key]||e.key.toLowerCase();a.keyState.release(t),f.ev.trigger("keyRelease",t)})},$.touchstart=e=>{e.preventDefault(),f.ev.onOnce("input",()=>{let t=[...e.changedTouches];t.forEach(n=>{f.ev.trigger("onTouchStart",Qe(p(n.clientX,n.clientY)),n)}),i.touchToMouse!==!1&&(Ct(t[0].clientX,t[0].clientY),a.mouseState.press("left"),f.ev.trigger("mousePress","left"))})},$.touchmove=e=>{e.preventDefault(),f.ev.onOnce("input",()=>{let t=[...e.changedTouches];t.forEach(n=>{f.ev.trigger("onTouchMove",Qe(p(n.clientX,n.clientY)),n)}),i.touchToMouse!==!1&&(f.ev.trigger("mouseMove","left"),Ct(t[0].clientX,t[0].clientY))})},$.touchend=e=>{f.ev.onOnce("input",()=>{[...e.changedTouches].forEach(n=>{f.ev.trigger("onTouchEnd",Qe(p(n.clientX,n.clientY)),n)}),i.touchToMouse!==!1&&(a.mouseState.release("left"),f.ev.trigger("mouseRelease","left"))})},$.touchcancel=e=>{f.ev.onOnce("input",()=>{[...e.changedTouches].forEach(n=>{f.ev.trigger("onTouchEnd",Qe(p(n.clientX,n.clientY)),n)}),i.touchToMouse!==!1&&(a.mouseState.release("left"),f.ev.trigger("mouseRelease","left"))})},$.wheel=e=>{e.preventDefault(),f.ev.onOnce("input",()=>{f.ev.trigger("scroll",p(e.deltaX,e.deltaY))})},$.contextmenu=e=>e.preventDefault(),Ke.visibilitychange=()=>{switch(document.visibilityState){case"visible":a.skipTime=!0,F.paused||C.ctx.resume();break;case"hidden":C.ctx.suspend();break}},De.error=e=>{e.error?Lt(e.error):Lt(new Error(e.message))},De.unhandledrejection=e=>Lt(e.reason);for(let e in $)a.canvas.addEventListener(e,$[e]);for(let e in Ke)document.addEventListener(e,Ke[e]);for(let e in De)window.addEventListener(e,De[e]);function Me(){return a.mousePos.clone()}u(Me,"mousePos");function fn(){return a.mouseDeltaPos.clone()}u(fn,"mouseDeltaPos");function ot(e="left"){return a.mouseState.pressed.has(e)}u(ot,"isMousePressed");function Vr(e="left"){return a.mouseState.down.has(e)}u(Vr,"isMouseDown");function Tt(e="left"){return a.mouseState.released.has(e)}u(Tt,"isMouseReleased");function kr(){return a.isMouseMoved}u(kr,"isMouseMoved");function Nr(e){return e===void 0?a.keyState.pressed.size>0:a.keyState.pressed.has(e)}u(Nr,"isKeyPressed");function jr(e){return e===void 0?a.keyState.pressedRepeat.size>0:a.keyState.pressedRepeat.has(e)}u(jr,"isKeyPressedRepeat");function _r(e){return e===void 0?a.keyState.down.size>0:a.keyState.down.has(e)}u(_r,"isKeyDown");function qr(e){return e===void 0?a.keyState.released.size>0:a.keyState.released.has(e)}u(qr,"isKeyReleased");function zr(e){return a.virtualButtonState.pressed.has(e)}u(zr,"isVirtualButtonPressed");function Hr(e){return a.virtualButtonState.down.has(e)}u(Hr,"isVirtualButtonDown");function $r(e){return a.virtualButtonState.released.has(e)}u($r,"isVirtualButtonReleased");function Yr(){return[...a.charInputted]}u(Yr,"charInputted");function At(){return a.time}u(At,"time");function Xr(){return a.canvas.toDataURL()}u(Xr,"screenshot");function mn(e){return e&&(a.canvas.style.cursor=e),a.canvas.style.cursor}u(mn,"setCursor");function Kr(e=!0){e?Qs(a.canvas):Js()}u(Kr,"setFullscreen");function Ot(){return Boolean(Zs())}u(Ot,"isFullscreen");function pn(){return a.isTouchScreen}u(pn,"isTouchScreen");let F={inspect:!1,timeScale:1,showLog:!0,fps:()=>a.fpsCounter.fps,numFrames:()=>a.numFrames,stepFrame:Rn,drawCalls:()=>g.drawCalls,clearLog:()=>f.logs=[],log:e=>{let t=i.logMax??Hs;f.logs.unshift(`${`[${At().toFixed(2)}].time `}[${e?.toString?e.toString():e}].${e instanceof Error?"error":"info"}`),f.logs.length>t&&(f.logs=f.logs.slice(0,t))},error:e=>F.log(new Error(e.toString?e.toString():e)),curRecording:null,get paused(){return a.paused},set paused(e){a.paused=e,e?C.ctx.suspend():C.ctx.resume()}};function Q(){return a.dt*F.timeScale}u(Q,"dt");function Qr(...e){return e.length>0&&(f.cam.pos=p(...e)),f.cam.pos?f.cam.pos.clone():ht()}u(Qr,"camPos");function Jr(...e){return e.length>0&&(f.cam.scale=p(...e)),f.cam.scale.clone()}u(Jr,"camScale");function Zr(e){return e!==void 0&&(f.cam.angle=e),f.cam.angle}u(Zr,"camRot");function Wr(e=12){f.cam.shake=e}u(Wr,"shake");function Pt(e){return f.cam.transform.multVec2(e)}u(Pt,"toScreen");function gn(e){return f.cam.transform.invert().multVec2(e)}u(gn,"toWorld");function wn(e){let t=new A;return e.pos&&(t=t.translate(e.pos)),e.scale&&(t=t.scale(e.scale)),e.angle&&(t=t.rotateZ(e.angle)),e.parent?t.mult(e.parent.transform):t}u(wn,"calcTransform");function vn(e){let t=new Map,n={},s=new oe,h={id:Zn(),hidden:!1,paused:!1,transform:new A,children:[],parent:null,add(o){let l=(()=>{if(Array.isArray(o))return vn(o);if(o.parent)throw new Error("Cannot add a game obj that already has a parent.");return o})();return l.parent=this,l.transform=wn(l),this.children.push(l),l.trigger("add",this),f.ev.trigger("add",this),l},readd(o){let l=this.children.indexOf(o);return l!==-1&&(this.children.splice(l,1),this.children.push(o)),o},remove(o){let l=this.children.indexOf(o);l!==-1&&(o.parent=null,o.trigger("destroy"),f.ev.trigger("destroy",o),this.children.splice(l,1))},removeAll(o){this.get(o).forEach(l=>this.remove(l))},update(){this.paused||(this.get().forEach(o=>o.update()),this.trigger("update"))},draw(){this.hidden||(ee(),G(this.pos),Pe(this.scale),ge(this.angle),this.trigger("draw"),this.get().forEach(o=>o.draw()),X())},drawInspect(){this.hidden||(ee(),G(this.pos),Pe(this.scale),ge(this.angle),this.get().forEach(o=>o.drawInspect()),this.trigger("drawInspect"),X())},use(o){if(!o)return;if(typeof o=="string")return this.use({id:o});o.id&&(this.unuse(o.id),t.set(o.id,{cleanups:[]}));let l=o.id?t.get(o.id):n,d=o.id?l.cleanups:[],m=u(()=>{if(o.require){for(let w of o.require)if(!this.c(w))throw new Error(`Component "${o.id}" requires component "${w}"`)}},"checkDeps");o.destroy&&d.push(o.destroy),o.require&&!this.exists()&&l.cleanups&&d.push(this.on("add",m));for(let w in o)if(!Xs.has(w)){if(typeof o[w]=="function"){let b=o[w].bind(this);if(Ks.has(w)){d.push(this.on(w,b)),l[w]=b;continue}else l[w]=b}else l[w]=o[w];if(this[w]===void 0)Object.defineProperty(this,w,{get:()=>l[w],set:b=>l[w]=b,configurable:!0,enumerable:!0});else throw new Error(`Duplicate component property: "${w}"`)}this.exists()&&(m(),o.add&&o.add.call(this))},unuse(o){if(t.has(o)){let l=t.get(o);l.cleanups.forEach(d=>d.cancel());for(let d in l)delete l[d]}t.delete(o)},c(o){return t.get(o)},get(o){return this.children.filter(l=>o?l.is(o):!0).sort((l,d)=>(l.z??0)-(d.z??0))},getAll(o){return this.children.sort((l,d)=>(l.z??0)-(d.z??0)).flatMap(l=>[l,...l.getAll(o)]).filter(l=>o?l.is(o):!0)},isAncestorOf(o){return o.parent?o.parent===this||this.isAncestorOf(o.parent):!1},exists(){return f.root.isAncestorOf(this)},is(o){if(o==="*")return!0;if(Array.isArray(o)){for(let l of o)if(!this.c(l))return!1;return!0}else return this.c(o)!=null},on(o,l){return s.on(o,l.bind(this))},trigger(o,...l){s.trigger(o,...l),f.objEvents.trigger(o,this,...l)},destroy(){this.parent&&this.parent.remove(this)},inspect(){let o={};for(let[l,d]of t)o[l]=d.inspect?d.inspect():null;return o},onAdd(o){return this.on("add",o)},onUpdate(o){return this.on("update",o)},onDraw(o){return this.on("draw",o)},onDestroy(o){return this.on("destroy",o)},clearEvents(){s.clear()}};for(let o of e)h.use(o);return h}u(vn,"make");function Fe(e,t,n){return f.objEvents[e]||(f.objEvents[e]=new xe),f.objEvents.on(e,(s,...h)=>{s.is(t)&&n(s,...h)})}u(Fe,"on");let Rt=u((e,t)=>{if(typeof e=="function"&&t===void 0){let n=Ze([{update:e}]);return{get paused(){return n.paused},set paused(s){n.paused=s},cancel:()=>n.destroy()}}else if(typeof e=="string")return Fe("update",e,t)},"onUpdate"),ei=u((e,t)=>{if(typeof e=="function"&&t===void 0){let n=Ze([{draw:e}]);return{get paused(){return n.hidden},set paused(s){n.hidden=s},cancel:()=>n.destroy()}}else if(typeof e=="string")return Fe("draw",e,t)},"onDraw");function bn(e,t){if(typeof e=="function"&&t===void 0)return f.ev.on("add",e);if(typeof e=="string")return Fe("add",e,t)}u(bn,"onAdd");function ti(e,t){if(typeof e=="function"&&t===void 0)return f.ev.on("destroy",e);if(typeof e=="string")return Fe("destroy",e,t)}u(ti,"onDestroy");function ni(e,t,n){return Fe("collide",e,(s,h,o)=>h.is(t)&&n(s,h,o))}u(ni,"onCollide");function at(e,t){An(e).forEach(t),bn(e,t)}u(at,"forAllCurrentAndFuture");function ri(e,t){if(typeof e=="function")return yn(e);{let n=[];return at(e,s=>{if(!s.area)throw new Error("onClick() requires the object to have area() component");n.push(s.onClick(()=>t(s)))}),ut(n)}}u(ri,"onClick");function ii(e,t){let n=[];return at(e,s=>{if(!s.area)throw new Error("onHover() requires the object to have area() component");n.push(s.onHover(()=>t(s)))}),ut(n)}u(ii,"onHover");function si(e,t){let n=[];return at(e,s=>{if(!s.area)throw new Error("onHoverUpdate() requires the object to have area() component");n.push(s.onHoverUpdate(()=>t(s)))}),ut(n)}u(si,"onHoverUpdate");function oi(e,t){let n=[];return at(e,s=>{if(!s.area)throw new Error("onHoverEnd() requires the object to have area() component");n.push(s.onHoverEnd(()=>t(s)))}),ut(n)}u(oi,"onHoverEnd");function Dt(e,t){let n=0,s=[];t&&s.push(t);let h=Rt(()=>{n+=Q(),n>=e&&(h.cancel(),s.forEach(o=>o()))});return{paused:h.paused,cancel:h.cancel,onFinish(o){s.push(o)},then(o){return this.onFinish(o),this}}}u(Dt,"wait");function ai(e,t){let n=null,s=u(()=>{t(),n=Dt(e,s)},"newAction");return s(),{get paused(){return n.paused},set paused(h){n.paused=h},cancel:()=>n.cancel()}}u(ai,"loop");function ut(e){return{get paused(){return e[0].paused},set paused(t){e.forEach(n=>n.paused=t)},cancel:()=>e.forEach(t=>t.cancel())}}u(ut,"joinEventControllers");let ui=u((e,t)=>{if(typeof e=="function")return f.ev.on("keyDown",e);if(typeof e=="string"&&typeof t=="function")return f.ev.on("keyDown",n=>n===e&&t(e))},"onKeyDown"),le=u((e,t)=>{if(typeof e=="function")return f.ev.on("keyPress",e);if(typeof e=="string"&&typeof t=="function")return f.ev.on("keyPress",n=>n===e&&t(e))},"onKeyPress"),ci=u((e,t)=>{if(typeof e=="function")return f.ev.on("keyPressRepeat",e);if(typeof e=="string"&&typeof t=="function")return f.ev.on("keyPressRepeat",n=>n===e&&t(e))},"onKeyPressRepeat"),li=u((e,t)=>{if(typeof e=="function")return f.ev.on("keyRelease",e);if(typeof e=="string"&&typeof t=="function")return f.ev.on("keyRelease",n=>n===e&&t(e))},"onKeyRelease");function hi(e,t){return typeof e=="function"?f.ev.on("mouseDown",n=>e(n)):f.ev.on("mouseDown",n=>n===e&&t(n))}u(hi,"onMouseDown");function yn(e,t){return typeof e=="function"?f.ev.on("mousePress",n=>e(n)):f.ev.on("mousePress",n=>n===e&&t(n))}u(yn,"onMousePress");function di(e,t){return typeof e=="function"?f.ev.on("mouseRelease",n=>e(n)):f.ev.on("mouseRelease",n=>n===e&&t(n))}u(di,"onMouseRelease");function fi(e){return f.ev.on("mouseMove",()=>e(Me(),fn()))}u(fi,"onMouseMove");function mi(e){return f.ev.on("charInput",e)}u(mi,"onCharInput");function pi(e){return f.ev.on("onTouchStart",e)}u(pi,"onTouchStart");function gi(e){return f.ev.on("onTouchMove",e)}u(gi,"onTouchMove");function wi(e){return f.ev.on("onTouchEnd",e)}u(wi,"onTouchEnd");function vi(e){return f.ev.on("scroll",e)}u(vi,"onScroll");function bi(e,t){return f.ev.on("virtualButtonDown",n=>n===e&&t())}u(bi,"onVirtualButtonDown");function yi(e,t){return f.ev.on("virtualButtonPress",n=>n===e&&t())}u(yi,"onVirtualButtonPress");function Ui(e,t){return f.ev.on("virtualButtonRelease",n=>n===e&&t())}u(Ui,"onVirtualButtonRelease");function Un(){le("f1",()=>{F.inspect=!F.inspect}),le("f2",()=>{F.clearLog()}),le("f8",()=>{F.paused=!F.paused}),le("f7",()=>{F.timeScale=Be(te(F.timeScale-.2,0,2),1)}),le("f9",()=>{F.timeScale=Be(te(F.timeScale+.2,0,2),1)}),le("f10",()=>{F.stepFrame()})}u(Un,"enterDebugMode");function xn(){le("b",()=>rn())}u(xn,"enterBurpMode");function xi(e){return e!==void 0&&(f.gravity=e),f.gravity}u(xi,"gravity");function ct(...e){return{id:"pos",pos:p(...e),moveBy(...t){this.pos=this.pos.add(p(...t))},move(...t){this.moveBy(p(...t).scale(Q()))},moveTo(...t){if(typeof t[0]=="number"&&typeof t[1]=="number")return this.moveTo(p(t[0],t[1]),t[2]);let n=t[0],s=t[1];if(s===void 0){this.pos=p(n);return}let h=n.sub(this.pos);if(h.len()<=s*Q()){this.pos=p(n);return}this.move(h.unit().scale(s))},worldPos(){return this.parent?this.parent.transform.multVec2(this.pos):this.pos},screenPos(){return this.fixed?this.pos:Pt(this.pos)},inspect(){return`(${Math.round(this.pos.x)}, ${Math.round(this.pos.y)})`},drawInspect(){we({color:x(255,0,0),radius:4/ln()})}}}u(ct,"pos");function lt(...e){return e.length===0?lt(1):{id:"scale",scale:p(...e),scaleTo(...t){this.scale=p(...t)},inspect(){return typeof this.scale=="number"?`${Be(this.scale,2)}`:`(${Be(this.scale.x,2)}, ${Be(this.scale.y,2)})`}}}u(lt,"scale");function Ei(e){return{id:"rotate",angle:e??0,rotate(t){this.rotateBy(t*Q())},rotateBy(t){this.angle+=t},inspect(){return`${Math.round(this.angle)}`}}}u(Ei,"rotate");function Si(...e){return{id:"color",color:x(...e),inspect(){return this.color.toString()}}}u(Si,"color");function Be(e,t){return Number(e.toFixed(t))}u(Be,"toFixed");function Ci(e){return{id:"opacity",opacity:e??1,inspect(){return`${Be(this.opacity,1)}`},fadeOut(t,n=fe.linear){return It(this.opacity,0,t,s=>this.opacity=s,n)}}}u(Ci,"opacity");function Mt(e){if(!e)throw new Error("Please define an anchor");return{id:"anchor",anchor:e,inspect(){return typeof this.anchor=="string"?this.anchor:this.anchor.toString()}}}u(Mt,"anchor");function Ti(e){return{id:"z",z:e,inspect(){return`${this.z}`}}}u(Ti,"z");function Ai(e,t){return{id:"follow",require:["pos"],follow:{obj:e,offset:t??p(0)},add(){e.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))},update(){e.exists()&&(this.pos=this.follow.obj.pos.add(this.follow.offset))}}}u(Ai,"follow");function Oi(e,t){let n=typeof e=="number"?D.fromAngle(e):e.unit();return{id:"move",require:["pos"],update(){this.move(n.scale(t))}}}u(Oi,"move");let Pi=200;function Ri(e={}){let t=e.distance??Pi,n=!1;return{id:"offscreen",require:["pos"],isOffScreen(){let s=Pt(this.pos),h=new V(p(0),j(),B());return!qe(h,s)&&h.distToPoint(s)>t},onExitScreen(s){return this.on("exitView",s)},onEnterScreen(s){return this.on("enterView",s)},update(){this.isOffScreen()?(n||(this.trigger("exitView"),n=!0),e.hide&&(this.hidden=!0),e.pause&&(this.paused=!0),e.destroy&&this.destroy()):(n&&(this.trigger("enterView"),n=!1),e.hide&&(this.hidden=!1),e.pause&&(this.paused=!1))},inspect(){return`${this.isOffScreen()}`}}}u(Ri,"offscreen");function Di(e={}){let t=[];return{id:"area",colliding:{},collisionIgnore:e.collisionIgnore??[],add(){this.area.cursor&&t.push(this.onHover(()=>mn(this.area.cursor))),t.push(this.onCollideUpdate((n,s)=>{this.colliding[n.id]||this.trigger("collide",n,s),this.colliding[n.id]=s}))},update(){for(let n in this.colliding){let s=this.colliding[n];this.checkCollision(s.target)||(delete this.colliding[n],this.trigger("collideEnd",s.target,s))}},drawInspect(){let n=this.localArea();ee(),Pe(this.area.scale),G(this.area.offset);let s={outline:{width:4/ln(),color:x(0,0,255)},anchor:this.anchor,fill:!1,fixed:this.fixed};n instanceof V?K({...s,pos:n.pos,width:n.width,height:n.height}):n instanceof se?ve({...s,pts:n.pts}):n instanceof de&&we({...s,pos:n.center,radius:n.radius}),X()},destroy(){t.forEach(n=>n.cancel())},area:{shape:e.shape??null,scale:e.scale??p(1),offset:e.offset??p(0),cursor:e.cursor??null},isClicked(){return ot()&&this.isHovering()},isHovering(){let n=this.fixed?Me():gn(Me());return this.hasPoint(n)},checkCollision(n){if(this===n||!n.area||!n.exists())return null;let s=this.worldArea(),h=n.worldArea();return Kn(s,h)},isColliding(n){let s=this.checkCollision(n);return s&&!s.isZero()},isTouching(n){return Boolean(this.checkCollision(n))},onClick(n){return this.onUpdate(()=>{this.isClicked()&&n()})},onHover(n){let s=!1;return this.onUpdate(()=>{s?s=this.isHovering():this.isHovering()&&(s=!0,n())})},onHoverUpdate(n){return this.onUpdate(()=>{this.isHovering()&&n()})},onHoverEnd(n){let s=!1;return this.onUpdate(()=>{s?this.isHovering()||(s=!1,n()):s=this.isHovering()})},onCollide(n,s){if(typeof n=="function"&&s===void 0)return this.on("collide",n);if(typeof n=="string")return this.onCollide((h,o)=>{h.is(n)&&s(h,o)})},onCollideUpdate(n,s){if(typeof n=="function"&&s===void 0)return this.on("collideUpdate",n);if(typeof n=="string")return this.on("collideUpdate",(h,o)=>h.is(n)&&s(h,o))},onCollideEnd(n,s){if(typeof n=="function"&&s===void 0)return this.on("collideEnd",n);if(typeof n=="string")return this.on("collideEnd",h=>h.is(n)&&s(h))},hasPoint(n){return Xn(this.worldArea(),n)},pushOut(n){let s=this.checkCollision(n);s&&(this.pos=this.pos.add(s))},pushOutAll(){f.root.getAll().forEach(this.pushOut)},localArea(){return this.area.shape?this.area.shape:this.renderArea()},worldArea(){let n=this.localArea();if(!(n instanceof se||n instanceof V))throw new Error("Only support polygon and rect shapes for now");let s=this.transform.scale(p(this.area.scale??1)).translate(this.area.offset);if(n instanceof V){let h=n.bbox(),o=nt(this.anchor||wt).add(1,1).scale(-.5).scale(h.width,h.height);s=s.translate(o)}return n.transform(s)},screenArea(){let n=this.worldArea();return this.fixed?n:n.transform(f.cam.transform)}}}u(Di,"area");function Je(e){return{color:e.color,opacity:e.opacity,anchor:e.anchor,outline:e.outline,fixed:e.fixed,shader:e.shader,uniform:e.uniform}}u(Je,"getRenderProps");function Ft(e,t={}){let n=null,s=null;if(!e)throw new Error("Please pass the resource name or data to sprite()");let h=u((o,l,d,m)=>{let w=p(1,1);return d&&m?(w.x=d/(o.width*l.w),w.y=m/(o.height*l.h)):d?(w.x=d/(o.width*l.w),w.y=w.x):m&&(w.y=m/(o.height*l.h),w.x=w.y),w},"calcTexScale");return{id:"sprite",width:0,height:0,frame:t.frame||0,quad:t.quad||new N(0,0,1,1),animSpeed:t.animSpeed??1,draw(){!n||sn({...Je(this),sprite:n,frame:this.frame,quad:this.quad,flipX:t.flipX,flipY:t.flipY,tiled:t.tiled,width:t.width,height:t.height})},update(){if(!n){let l=tn(e);if(!l||!l.data)return;let d=l.data.frames[0].clone();t.quad&&(d=d.scale(t.quad));let m=h(l.data.tex,d,t.width,t.height);this.width=l.data.tex.width*d.w*m.x,this.height=l.data.tex.height*d.h*m.y,t.anim&&this.play(t.anim),n=l.data,this.trigger("spriteLoaded",n)}if(!s)return;let o=n.anims[s.name];if(typeof o=="number"){this.frame=o;return}if(o.speed===0)throw new Error("Sprite anim speed cannot be 0");s.timer+=Q()*this.animSpeed,s.timer>=1/s.speed&&(s.timer=0,o.from>o.to?(this.frame--,this.frame<o.to&&(s.loop?this.frame=o.from:(this.frame++,s.onEnd(),this.stop()))):(this.frame++,this.frame>o.to&&(s.loop?this.frame=o.from:(this.frame--,s.onEnd(),this.stop()))))},play(o,l={}){if(!n){this.on("spriteLoaded",()=>{this.play(o,l)});return}let d=n.anims[o];if(!d)throw new Error(`Anim not found: ${o}`);s&&this.stop(),s=typeof d=="number"?{name:o,timer:0,loop:!1,pingpong:!1,speed:0,onEnd:()=>{}}:{name:o,timer:0,loop:l.loop??d.loop??!1,pingpong:l.pingpong??d.pingpong??!1,speed:l.speed??d.speed??10,onEnd:l.onEnd??(()=>{})},this.frame=typeof d=="number"?d:d.from,this.trigger("animStart",o)},stop(){if(!s)return;let o=s.name;s=null,this.trigger("animEnd",o)},numFrames(){return n?n.frames.length:0},curAnim(){return s?.name},flipX(o){t.flipX=o},flipY(o){t.flipY=o},onAnimEnd(o,l){return this.on("animEnd",d=>{d===o&&l()})},onAnimStart(o,l){return this.on("animStart",d=>{d===o&&l()})},renderArea(){return new V(p(0),this.width,this.height)},inspect(){if(typeof e=="string")return`"${e}"`}}}u(Ft,"sprite");function Mi(e,t={}){function n(s){let h=be({...Je(s),text:s.text+"",size:s.textSize,font:s.font,width:t.width&&s.width,align:s.align,letterSpacing:s.letterSpacing,lineSpacing:s.lineSpacing,transform:s.textTransform,styles:s.textStyles});return t.width||(s.width=h.width/(s.scale?.x||1)),s.height=h.height/(s.scale?.y||1),h}return u(n,"update"),{id:"text",text:e,textSize:t.size??zs,font:t.font,width:t.width,height:0,align:t.align,lineSpacing:t.lineSpacing,letterSpacing:t.letterSpacing,textTransform:t.transform,textStyles:t.styles,add(){Bt(()=>n(this))},draw(){ye(n(this))},renderArea(){return new V(p(0),this.width,this.height)}}}u(Mi,"text");function Fi(e,t,n={}){return{id:"rect",width:e,height:t,radius:n.radius||0,draw(){K({...Je(this),width:this.width,height:this.height,radius:this.radius})},renderArea(){return new V(p(0),this.width,this.height)},inspect(){return`${Math.ceil(this.width)}, ${Math.ceil(this.height)}`}}}u(Fi,"rect");function Bi(e,t){return{id:"rect",width:e,height:t,draw(){Re({...Je(this),width:this.width,height:this.height})},renderArea(){return new V(p(0),this.width,this.height)},inspect(){return`${Math.ceil(this.width)}, ${Math.ceil(this.height)}`}}}u(Bi,"uvquad");function Li(e){return{id:"circle",radius:e,draw(){we({...Je(this),radius:this.radius})},renderArea(){return new de(p(0),this.radius)},inspect(){return`${Math.ceil(this.radius)}`}}}u(Li,"circle");function Ii(e=1,t=x(0,0,0)){return{id:"outline",outline:{width:e,color:t}}}u(Ii,"outline");function En(e,t){let n=new xe;return e&&t&&n.pushd(new pe(e,t)),{id:"timer",wait(s,h){let o=[h],l=new pe(s,()=>o.forEach(m=>m())),d=n.pushd(l);return{get paused(){return l.paused},set paused(m){l.paused=m},cancel:d,onFinish(m){o.push(m)},then(m){return this.onFinish(m),this}}},update(){n.forEach((s,h)=>{s.tick(Q())&&n.delete(h)})}}}u(En,"timer");let Gi=640,Vi=65536;function ki(e={}){let t=0,n=null,s=null,h=!1,o=[];return{id:"body",require:["pos","area"],jumpForce:e.jumpForce??Gi,gravityScale:e.gravityScale??1,isStatic:e.isStatic??!1,mass:e.mass??0,add(){o.push(this.onCollideUpdate((l,d)=>{if(!l.is("body")||d.resolved||this.isStatic&&l.isStatic)return;let m=!this.isStatic&&l.isStatic?d:d.reverse();m.source.trigger("beforePhysicsResolve",m),m.target.trigger("beforePhysicsResolve",m.reverse()),!d.resolved&&(m.source.pos=m.source.pos.add(m.displacement),m.source.transform=wn(m.source),d.resolved=!0,m.source.trigger("physicsResolve",m),m.target.trigger("physicsResolve",m.reverse()))})),o.push(this.onPhysicsResolve(l=>{f.gravity&&(l.isBottom()&&this.isFalling()?(t=0,n=l.target,s=l.target.pos,h?h=!1:this.trigger("ground",n)):l.isTop()&&this.isJumping()&&(t=0,this.trigger("headbutt",l.target)))}))},update(){if(!f.gravity||this.isStatic)return;if(h&&(n=null,s=null,this.trigger("fallOff"),h=!1),n)if(!this.isTouching(n)||!n.exists()||!n.is("body"))h=!0;else{!n.pos.eq(s)&&e.stickToPlatform!==!1&&this.moveBy(n.pos.sub(s)),s=n.pos;return}let l=t;t+=f.gravity*this.gravityScale*Q(),t=Math.min(t,e.maxVelocity??Vi),l<0&&t>=0&&this.trigger("fall"),this.move(0,t)},destroy(){o.forEach(l=>l.cancel())},onPhysicsResolve(l){return this.on("physicsResolve",l)},onBeforePhysicsResolve(l){return this.on("beforePhysicsResolve",l)},curPlatform(){return n},isGrounded(){return n!==null},isFalling(){return t>0},isJumping(){return t<0},jump(l){n=null,s=null,t=-l||-this.jumpForce},onGround(l){return this.on("ground",l)},onFall(l){return this.on("fall",l)},onFallOff(l){return this.on("fallOff",l)},onHeadbutt(l){return this.on("headbutt",l)}}}u(ki,"body");function Ni(e=2){let t=e,n=[];return{id:"doubleJump",require:["body"],numJumps:e,add(){n.push(this.onGround(()=>{t=this.numJumps}))},destroy(){n.forEach(s=>s.cancel())},doubleJump(s){t<=0||(t<this.numJumps&&this.trigger("doubleJump"),t--,this.jump(s))},onDoubleJump(s){return this.on("doubleJump",s)},inspect(){return`${t}`}}}u(Ni,"doubleJump");function ji(e,t={}){return{id:"shader",shader:e,uniform:t}}u(ji,"shader");function _i(){return{id:"fixed",fixed:!0}}u(_i,"fixed");function Sn(e){return{id:"stay",stay:!0,scenesToStay:e}}u(Sn,"stay");function qi(e){if(e==null)throw new Error("health() requires the initial amount of hp");return{id:"health",hurt(t=1){this.setHP(e-t),this.trigger("hurt")},heal(t=1){this.setHP(e+t),this.trigger("heal")},hp(){return e},setHP(t){e=t,e<=0&&this.trigger("death")},onHurt(t){return this.on("hurt",t)},onHeal(t){return this.on("heal",t)},onDeath(t){return this.on("death",t)},inspect(){return`${e}`}}}u(qi,"health");function zi(e,t={}){if(e==null)throw new Error("lifespan() requires time");let n=t.fade??0;return{id:"lifespan",async add(){await Dt(e),n>0&&this.opacity&&await It(this.opacity,0,n,s=>this.opacity=s,fe.linear),this.destroy()}}}u(zi,"lifespan");function Hi(e,t,n){if(!e)throw new Error("state() requires an initial state");let s={};function h(m){s[m]||(s[m]={enter:new W,end:new W,update:new W,draw:new W})}u(h,"initStateEvents");function o(m,w,b){return h(w),s[w][m].add(b)}u(o,"on");function l(m,w,...b){h(w),s[w][m].trigger(...b)}u(l,"trigger");let d=!1;return{id:"state",state:e,enterState(m,...w){if(d=!0,t&&!t.includes(m))throw new Error(`State not found: ${m}`);let b=this.state;if(n){if(!n?.[b])return;let y=typeof n[b]=="string"?[n[b]]:n[b];if(!y.includes(m))throw new Error(`Cannot transition state from "${b}" to "${m}". Available transitions: ${y.map(L=>`"${L}"`).join(", ")}`)}l("end",b,...w),this.state=m,l("enter",m,...w),l("enter",`${b} -> ${m}`,...w)},onStateTransition(m,w,b){return o("enter",`${m} -> ${w}`,b)},onStateEnter(m,w){return o("enter",m,w)},onStateUpdate(m,w){return o("update",m,w)},onStateDraw(m,w){return o("draw",m,w)},onStateEnd(m,w){return o("end",m,w)},update(){d||(l("enter",e),d=!0),l("update",this.state)},draw(){l("draw",this.state)},inspect(){return this.state}}}u(Hi,"state");function $i(e=1){let t=0,n=!1;return{require:["opacity"],add(){this.opacity=0},update(){n||(t+=Q(),this.opacity=pt(t,0,e,0,1),t>=e&&(this.opacity=1,n=!0))}}}u($i,"fadeIn");function Bt(e){U.loaded?e():f.ev.on("load",e)}u(Bt,"onLoad");function Yi(e,t){f.scenes[e]=t}u(Yi,"scene");function Xi(e,...t){if(!f.scenes[e])throw new Error(`Scene not found: ${e}`);f.ev.onOnce("frameEnd",()=>{f.ev=new oe,f.objEvents=new oe,f.root.get().forEach(n=>{(!n.stay||n.scenesToStay&&!n.scenesToStay.includes(e))&&f.root.remove(n)}),f.root.clearEvents(),f.cam={pos:null,scale:p(1),angle:0,shake:0,transform:new A},f.gravity=0,f.scenes[e](...t),i.debug!==!1&&Un(),i.burp&&xn()})}u(Xi,"go");function Ki(e,t){try{return JSON.parse(window.localStorage[e])}catch{return t?(Cn(e,t),t):null}}u(Ki,"getData");function Cn(e,t){window.localStorage[e]=JSON.stringify(t)}u(Cn,"setData");function Tn(e){let t=e(Le);for(let n in t)Le[n]=t[n],i.global!==!1&&(window[n]=t[n]);return Le}u(Tn,"plug");function ht(){return p(j()/2,B()/2)}u(ht,"center");function Qi(e,t){return{id:"grid",gridPos:t.clone(),setGridPos(...n){let s=p(...n);this.gridPos=s.clone(),this.pos=p(this.gridPos.x*e.gridWidth(),this.gridPos.y*e.gridHeight())},moveLeft(){this.setGridPos(this.gridPos.add(p(-1,0)))},moveRight(){this.setGridPos(this.gridPos.add(p(1,0)))},moveUp(){this.setGridPos(this.gridPos.add(p(0,-1)))},moveDown(){this.setGridPos(this.gridPos.add(p(0,1)))}}}u(Qi,"grid");function Ji(e,t){if(!t.width||!t.height)throw new Error("Must provide level grid width & height.");let n=Ze([ct(t.pos??p(0))]),s=0,h={id:"level",gridWidth(){return t.width},gridHeight(){return t.height},getPos(...o){let l=p(...o);return p(l.x*t.width,l.y*t.height)},spawn(o,...l){let d=p(...l),m=(()=>{if(t[o]){if(typeof t[o]!="function")throw new Error("Level symbol def must be a function returning a component list");return t[o](d)}else if(t.any)return t.any(o,d)})();if(!m)return;let w=p(d.x*t.width,d.y*t.height);for(let b of m)if(b.id==="pos"){w.x+=b.pos.x,w.y+=b.pos.y;break}return m.push(ct(w)),m.push(Qi(this,d)),n.add(m)},levelWidth(){return s*t.width},levelHeight(){return e.length*t.height}};return n.use(h),e.forEach((o,l)=>{let d=o.split("");s=Math.max(d.length,s),d.forEach((m,w)=>{n.spawn(m,p(w,l))})}),n}u(Ji,"addLevel");function Zi(e){let t=a.canvas.captureStream(e),n=C.ctx.createMediaStreamDestination();C.masterNode.connect(n);let s=new MediaRecorder(t),h=[];return s.ondataavailable=o=>{o.data.size>0&&h.push(o.data)},s.onerror=()=>{C.masterNode.disconnect(n),t.getTracks().forEach(o=>o.stop())},s.start(),{resume(){s.resume()},pause(){s.pause()},stop(){return s.stop(),C.masterNode.disconnect(n),t.getTracks().forEach(o=>o.stop()),new Promise(o=>{s.onstop=()=>{o(new Blob(h,{type:"video/mp4"}))}})},download(o="kaboom.mp4"){this.stop().then(l=>zt(o,l))}}}u(Zi,"record");function Wi(){return document.activeElement===a.canvas}u(Wi,"isFocused");function es(e){e.destroy()}u(es,"destroy");let Ze=f.root.add.bind(f.root),ts=f.root.readd.bind(f.root),ns=f.root.removeAll.bind(f.root),An=f.root.get.bind(f.root),On=f.root.getAll.bind(f.root);function Pn(e=2,t=1){let n=0;return{id:"boom",require:["scale"],update(){let s=Math.sin(n*e)*t;s<0&&this.destroy(),this.scale=p(s),n+=Q()}}}u(Pn,"boom");let rs=Oe(null,tr),is=Oe(null,nr);function ss(e,t={}){let n=Ze([ct(e),Sn()]),s=(t.speed||1)*5,h=t.scale||1;n.add([Ft(is),lt(0),Mt("center"),Pn(s,h),...t.comps??[]]);let o=n.add([Ft(rs),lt(0),Mt("center"),En(.4/s,()=>o.use(Pn(s,h))),...t.comps??[]]);return o.onDestroy(()=>n.destroy()),n}u(ss,"addKaboom");function os(){f.ev.trigger("input"),a.keyState.down.forEach(e=>f.ev.trigger("keyDown",e)),a.mouseState.down.forEach(e=>f.ev.trigger("mouseDown",e)),a.virtualButtonState.down.forEach(e=>f.ev.trigger("virtualButtonDown",e))}u(os,"inputFrame");function Rn(){f.root.update()}u(Rn,"updateFrame");let as=64;class dt{source;target;displacement;resolved=!1;constructor(t,n,s,h=!1){this.source=t,this.target=n,this.displacement=s,this.resolved=h}reverse(){return new dt(this.target,this.source,this.displacement.scale(-1),this.resolved)}isLeft(){return this.displacement.x>0}isRight(){return this.displacement.x<0}isTop(){return this.displacement.y>0}isBottom(){return this.displacement.y<0}preventResolve(){this.resolved=!0}}u(dt,"Collision");function us(){let e={},t=i.hashGridSize||as,n=new A,s=[];function h(o){if(s.push(n),o.pos&&(n=n.translate(o.pos)),o.scale&&(n=n.scale(o.scale)),o.angle&&(n=n.rotateZ(o.angle)),o.transform=n.clone(),o.c("area")&&!o.paused){let l=o,m=l.worldArea().bbox(),w=Math.floor(m.pos.x/t),b=Math.floor(m.pos.y/t),y=Math.ceil((m.pos.x+m.width)/t),L=Math.ceil((m.pos.y+m.height)/t),P=new Set;for(let q=w;q<=y;q++)for(let z=b;z<=L;z++)if(!e[q])e[q]={},e[q][z]=[l];else if(!e[q][z])e[q][z]=[l];else{let Ue=e[q][z];for(let J of Ue){if(!J.exists()||P.has(J.id))continue;for(let S of l.collisionIgnore)J.is(S);for(let S of J.collisionIgnore)l.is(S);let _=l.checkCollision(J);if(_&&!_.isZero()){let S=new dt(l,J,_);l.trigger("collideUpdate",J,S);let k=S.reverse();k.resolved=S.resolved,J.trigger("collideUpdate",l,k)}P.add(J.id)}Ue.push(l)}}o.get().forEach(h),n=s.pop()}u(h,"checkObj"),h(f.root)}u(us,"checkFrame");function cs(){let e=f.cam,t=D.fromAngle(tt(0,360)).scale(e.shake);e.shake=_e(e.shake,0,5*Q()),e.transform=new A().translate(ht()).scale(e.scale).rotateZ(e.angle).translate((e.pos??ht()).scale(-1).add(t)),f.root.draw(),ce()}u(cs,"drawFrame");function ls(){let e=I();ae(()=>{let t=j()/2,n=24,s=p(j()/2,B()/2).sub(p(t/2,n/2));K({pos:p(0),width:j(),height:B(),color:x(0,0,0)}),K({pos:s,width:t,height:n,fill:!1,outline:{width:4}}),K({pos:s,width:t*e,height:n})}),f.ev.trigger("loading",e)}u(ls,"drawLoadScreen");function Dn(e,t){ae(()=>{let n=p(8);ee(),G(e);let s=be({text:t,font:vt,size:16,pos:n,color:x(255,255,255),fixed:!0}),h=s.width+n.x*2,o=s.height+n.x*2;e.x+h>=j()&&G(p(-h,0)),e.y+o>=B()&&G(p(0,-o)),K({width:h,height:o,color:x(0,0,0),radius:4,opacity:.8,fixed:!0}),ye(s),X()})}u(Dn,"drawInspectText");function hs(){if(F.inspect){let e=null;for(let t of On())if(t.c("area")&&t.isHovering()){e=t;break}if(f.root.drawInspect(),e){let t=[],n=e.inspect();for(let s in n)n[s]?t.push(`${s}: ${n[s]}`):t.push(`${s}`);Dn(Gr(Me()),t.join(`
`))}Dn(p(8),`FPS: ${F.fps()}`)}F.paused&&ae(()=>{ee(),G(j(),0),G(-8,8);let e=32;K({width:e,height:e,anchor:"topright",color:x(0,0,0),opacity:.8,radius:4,fixed:!0});for(let t=1;t<=2;t++)K({width:4,height:e*.6,anchor:"center",pos:p(-e/3*t,e*.5),color:x(255,255,255),radius:2,fixed:!0});X()}),F.timeScale!==1&&ae(()=>{ee(),G(j(),B()),G(-8,-8);let e=8,t=be({text:F.timeScale.toFixed(1),font:vt,size:16,color:x(255,255,255),pos:p(-e),anchor:"botright",fixed:!0});K({width:t.width+e*2+e*4,height:t.height+e*2,anchor:"botright",color:x(0,0,0),opacity:.8,radius:4,fixed:!0});for(let n=0;n<2;n++){let s=F.timeScale<1;an({p1:p(-t.width-e*(s?2:3.5),-e),p2:p(-t.width-e*(s?2:3.5),-e-t.height),p3:p(-t.width-e*(s?3.5:2),-e-t.height/2),pos:p(-n*e*1+(s?-e*.5:0),0),color:x(255,255,255),fixed:!0})}ye(t),X()}),F.curRecording&&ae(()=>{ee(),G(0,B()),G(24,-24),we({radius:12,color:x(255,0,0),opacity:Nt(0,1,At()*4),fixed:!0}),X()}),F.showLog&&f.logs.length>0&&ae(()=>{ee(),G(0,B()),G(8,-8);let e=8,t=be({text:f.logs.join(`
`),font:vt,pos:p(e,-e),anchor:"botleft",size:16,width:j()*.6,lineSpacing:e/2,fixed:!0,styles:{time:{color:x(127,127,127)},info:{color:x(255,255,255)},error:{color:x(255,0,127)}}});K({width:t.width+e*2,height:t.height+e*2,anchor:"botleft",color:x(0,0,0),radius:4,opacity:.8,fixed:!0}),ye(t),X()})}u(hs,"drawDebug");function ds(){let e=Me(),t=u((s,h,o)=>{we({radius:80/2,pos:s,outline:{width:4,color:x(0,0,0)},opacity:.5,fixed:!0}),o&&st({text:o,pos:s,color:x(0,0,0),size:40,anchor:"center",opacity:.5,fixed:!0}),ot("left")&&Yn(new de(s,80/2),e)&&f.ev.onOnce("input",()=>{a.virtualButtonState.press(h),f.ev.trigger("virtualButtonPress",h),a.keyState.press(h),f.ev.trigger("keyPress",h)}),Tt("left")&&f.ev.onOnce("input",()=>{a.virtualButtonState.release(h),f.ev.trigger("virtualButtonRelease",h),a.keyState.release(h),f.ev.trigger("keyRelease",h)})},"drawCircleButton"),n=u((s,h,o)=>{K({width:64,height:64,pos:s,outline:{width:4,color:x(0,0,0)},radius:4,anchor:"center",opacity:.5,fixed:!0}),o&&st({text:o,pos:s,color:x(0,0,0),size:40,anchor:"center",opacity:.5,fixed:!0}),ot("left")&&qe(new V(s.add(-64/2,-64/2),64,64),e)&&f.ev.onOnce("input",()=>{a.virtualButtonState.press(h),f.ev.trigger("virtualButtonPress",h),a.keyState.press(h),f.ev.trigger("keyPress",h)}),Tt("left")&&f.ev.onOnce("input",()=>{a.virtualButtonState.release(h),f.ev.trigger("virtualButtonRelease",h),a.keyState.release(h),f.ev.trigger("keyRelease",h)})},"drawSquareButton");ae(()=>{t(p(j()-80,B()-160),"a"),t(p(j()-160,B()-80),"b"),n(p(60,B()-124),"left"),n(p(188,B()-124),"right"),n(p(124,B()-188),"up"),n(p(124,B()-60),"down")})}u(ds,"drawVirtualControls"),i.debug!==!1&&Un(),i.burp&&xn();function fs(e){f.ev.on("loading",e)}u(fs,"onLoadUpdate");function ms(e){f.ev.on("resize",e)}u(ms,"onResize");function ps(e){f.ev.on("error",e)}u(ps,"onError");function Lt(e){Mn(()=>{ae(()=>{let s=j(),h=B(),o={size:36,width:s-32*2,letterSpacing:4,lineSpacing:4,font:vt,fixed:!0};K({width:s,height:h,color:x(0,0,255),fixed:!0});let l=be({...o,text:e.name,pos:p(32),color:x(255,128,0),fixed:!0});ye(l),st({...o,text:e.message,pos:p(32,32+l.height+16),fixed:!0}),X(),f.ev.trigger("error",e)})})}u(Lt,"handleErr");function gs(){a.keyState.update(),a.mouseState.update(),a.virtualButtonState.update(),a.charInputted=[],a.isMouseMoved=!1}u(gs,"resetInputState");function Mn(e){a.loopID!==null&&cancelAnimationFrame(a.loopID);let t=u(n=>{if(a.stopped)return;if(document.visibilityState!=="visible"){a.loopID=requestAnimationFrame(t);return}let s=n/1e3,h=s-a.realTime;a.realTime=s,a.skipTime||(a.dt=h,a.time+=Q(),a.fpsCounter.tick(a.dt)),a.skipTime=!1,a.numFrames++,Cr(),e(),Tr(),gs(),f.ev.trigger("frameEnd"),a.loopID=requestAnimationFrame(t)},"frame");t(0)}u(Mn,"run");function ws(){f.ev.onOnce("frameEnd",()=>{a.stopped=!0,c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT|c.STENCIL_BUFFER_BIT);let e=c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS);for(let t=0;t<e;t++)c.activeTexture(c.TEXTURE0+t),c.bindTexture(c.TEXTURE_2D,null),c.bindTexture(c.TEXTURE_CUBE_MAP,null);c.bindBuffer(c.ARRAY_BUFFER,null),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,null),c.bindRenderbuffer(c.RENDERBUFFER,null),c.bindFramebuffer(c.FRAMEBUFFER,null),r.forEach(t=>t()),c.deleteBuffer(g.vbuf),c.deleteBuffer(g.ibuf);for(let t in $)a.canvas.removeEventListener(t,$[t]);for(let t in Ke)document.removeEventListener(t,Ke[t]);for(let t in De)window.removeEventListener(t,De[t])})}u(ws,"quit");function It(e,t,n,s,h=fe.linear){let o=0,l=[],d=Rt(()=>{o+=Q();let m=Math.min(o/n,1);s(_e(e,t,h(m))),m===1&&(d.cancel(),s(t),l.forEach(w=>w()))});return{get paused(){return d.paused},set paused(m){d.paused=m},onFinish(m){l.push(m)},then(m){return this.onFinish(m),this},cancel(){d.cancel()},finish(){d.cancel(),s(t),l.forEach(m=>m())}}}u(It,"tween"),Te("happy",Wn,28,36),Mn(()=>{U.loaded||I()===1&&(U.loaded=!0,f.ev.trigger("load")),!U.loaded&&i.loadingScreen!==!1?ls():(os(),F.paused||Rn(),us(),cs(),i.debug!==!1&&hs(),i.virtualControls&&pn()&&ds())});let Le={VERSION:Gs,loadRoot:Y,loadProgress:I,loadSprite:Oe,loadSpriteAtlas:Qt,loadSound:vr,loadBitmapFont:Te,loadFont:Ut,loadShader:wr,loadAseprite:gr,loadPedit:pr,loadBean:br,load:ue,getSprite:Jt,getSound:Zt,getFont:yr,getBitmapFont:Wt,getShader:en,Asset:O,SpriteData:T,SoundData:R,width:j,height:B,center:ht,dt:Q,time:At,screenshot:Xr,record:Zi,isFocused:Wi,setCursor:mn,setFullscreen:Kr,isFullscreen:Ot,isTouchScreen:pn,onLoad:Bt,onLoadUpdate:fs,onResize:ms,onError:ps,camPos:Qr,camScale:Jr,camRot:Zr,shake:Wr,toScreen:Pt,toWorld:gn,gravity:xi,add:Ze,destroy:es,destroyAll:ns,get:An,getAll:On,readd:ts,pos:ct,scale:lt,rotate:Ei,color:Si,opacity:Ci,anchor:Mt,area:Di,sprite:Ft,text:Mi,rect:Fi,circle:Li,uvquad:Bi,outline:Ii,body:ki,doubleJump:Ni,shader:ji,timer:En,fixed:_i,stay:Sn,health:qi,lifespan:zi,z:Ti,move:Oi,offscreen:Ri,follow:Ai,state:Hi,fadeIn:$i,on:Fe,onUpdate:Rt,onDraw:ei,onAdd:bn,onDestroy:ti,onCollide:ni,onClick:ri,onHover:ii,onHoverUpdate:si,onHoverEnd:oi,onKeyDown:ui,onKeyPress:le,onKeyPressRepeat:ci,onKeyRelease:li,onMouseDown:hi,onMousePress:yn,onMouseRelease:di,onMouseMove:fi,onCharInput:mi,onTouchStart:pi,onTouchMove:gi,onTouchEnd:wi,onScroll:vi,onVirtualButtonPress:yi,onVirtualButtonDown:bi,onVirtualButtonRelease:Ui,mousePos:Me,mouseDeltaPos:fn,isKeyDown:_r,isKeyPressed:Nr,isKeyPressedRepeat:jr,isKeyReleased:qr,isMouseDown:Vr,isMousePressed:ot,isMouseReleased:Tt,isMouseMoved:kr,isVirtualButtonPressed:zr,isVirtualButtonDown:Hr,isVirtualButtonReleased:$r,charInputted:Yr,loop:ai,wait:Dt,play:$e,volume:Er,burp:rn,audioCtx:C.ctx,Timer:pe,Line:re,Rect:V,Circle:de,Polygon:se,Vec2:D,Color:E,Mat4:A,Quad:N,RNG:Ne,rand:tt,randi:jt,randSeed:_n,vec2:p,rgb:x,hsl2rgb:Nn,quad:jn,choose:zn,chance:qn,lerp:_e,tween:It,easings:fe,map:pt,mapc:kn,wave:Nt,deg2rad:he,rad2deg:kt,testLineLine:Ve,testRectRect:Hn,testRectLine:$n,testRectPoint:qe,drawSprite:sn,drawText:st,formatText:be,drawRect:K,drawLine:Xe,drawLines:on,drawTriangle:an,drawCircle:we,drawEllipse:un,drawUVQuad:Re,drawPolygon:ve,drawFormattedText:ye,drawMasked:Fr,drawSubtracted:Br,pushTransform:ee,popTransform:X,pushTranslate:G,pushScale:Pe,pushRotate:Dr,pushRotateX:Pr,pushRotateY:Rr,pushRotateZ:ge,pushMatrix:Or,debug:F,scene:Yi,go:Xi,addLevel:Ji,getData:Ki,setData:Cn,download:gt,downloadJSON:Jn,downloadText:qt,downloadBlob:zt,plug:Tn,ASCII_CHARS:sr,canvas:a.canvas,addKaboom:ss,LEFT:D.LEFT,RIGHT:D.RIGHT,UP:D.UP,DOWN:D.DOWN,RED:E.RED,GREEN:E.GREEN,BLUE:E.BLUE,YELLOW:E.YELLOW,MAGENTA:E.MAGENTA,CYAN:E.CYAN,WHITE:E.WHITE,BLACK:E.BLACK,quit:ws,Event:W,EventHandler:oe};if(i.plugins&&i.plugins.forEach(Tn),i.global!==!1)for(let e in Le)window[e]=Le[e];return a.canvas.focus(),Le},"default");return Cs(to);})();
window.kaboom = kaboom.default
//# sourceMappingURL=kaboom.js.map
